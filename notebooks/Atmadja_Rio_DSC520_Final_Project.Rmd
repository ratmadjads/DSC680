---
title: 'DSC520 Final Project: North Korea Missile Tests Analysis'
author: "Rio Atmadja"
date: "7/23/2020"
output:
  html_document:
    df_print: paged
  pdf_document: default
  word_document: default
---

### Missile Type Descriptions:
- **SRBM**: Short-range ballistic missile
- **Unknown**: Unknown Types
- **MRBM**: Medium range ballistic missile 
- **SLV**: Satellite Lauch Vehicle 
- **SLBM**: Submarine-launced ballistic missile
- **IRBM**: Intermediate-range ballistic missile 
- **ICBM**: Intercontinental ballastic missile 

```{r loading_packages, include=FALSE, echo=FALSE, results='hide'}
# ### Home of the Ravens
#                                       `..---:::://///::::--..``
#                           `.:/+osyyhddddddddddddddddddddddddddddhhyso+/:-.`
#                   `-:+oyhddddddddmmmmmmNNNNNNNNNNNNNNNNNNNNNNmmmmmmmdddddddhys+/:.`
#            `.:+syddddddmmmmNNNNMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMNNNNmmmddddddhso/-`
#       `-/shdddddmmmNNNMMMMMMMMMMMMMMMMNNmmdNMMNhhhhhhhhdddmmNNMMMMMMMMMMMMMMMMMNNNmmmddddhs+:.
#   -/shddddmmmNNMMMMMMMMMMMMMMMm+/:+NMd+`  -NMMN-`sNN-   +yyy+-sMMy:/+yMMMNNMMMMMMMMMMNNNmmmddddy+:`
#  `dddmmNNMMMMMMMMNdhyssymMMMMh..   .yMMh.  -mm-.hMMM-   :oo::NNMMm  . .sNNs.:yNMMMMMMMMMMMMNNmmddd/
#  :ddmMMMMMMNds+:.:yy.  `sMMMs`/h/    :mMm/  ..-mMMMM-   sNNmyNNMMm  Ny- `+y `MMm.``-ssydNMMMMMMmddy
#  oddmMMMMNo-s+   :o:  -hMMN/`oyhdh` `.-yNMs` +NMMMMh+///+ooo+-yMMy  mMMh/ ` `MMNo. `+hd+/dMMMMMNddd`
#  hddNMMMMMMNMo   /d+`  `:y+/omMMMmmNNNNNMMMdyMMMMMMMMMMMMMMNNNMMMmdhhNMMMm+``MMMNddo-`.+hMMMMMMMddd.
# `dddNMMMMMMMM+  `/mMNhdmNNMMMMMMMMNNmmdddhhhhyyyyyNMMMMMMMMmhddmmNNMMMMMMMMmoMMmo:+hdh-  -NMMMMMmdd:
# .dddNMMMMMMMdsydNNMMMMMNmdhhysoo++////////////////mMMMMMMMMy::::::://ymhyhhdmNMMMNNmhs+//oMMMMMMmdd+
# -dddMMMMMMMMMMMNmdhso++/////::::-------------::///:ohNMMMMMy---------sMNmy+:::/+oMMMMMMMMMMMMMMMmddo
# :ddmMMMMMNdyso+//////::-..-://+osyyhhdddddhyso/:.---::odNMMy---------sMMMMNmy+:--MMMMMMMMMMMMMMMmdds
# :ddmMMMMMd///////:-.-/oydmdddddhhhhhhhddmNMMMMMNNh/`---:/ody---------sMMMMMMMNms+MMMMMMMMMMMMMMMmdds
# :ddmMMMMMh////:.``-///:-----.`.:/+oo`.----:sNMMMMMMy -----:sho:------sMMMMMMMMMMNoymMMMMMMMMMMMMmddy
# :ddmMMMMMd/:-...--::::://:.-+hmNMMMo`:////:`+MMMMMMy ------sMMmy+:---sMMMMMMMMMMM:-:+ymMMMMMMMMMmdds
# :ddmMMMMMd//////////////-.sNMMMMMMy`://///:`oMMMMmo`.------sMMMMMmy+:sMMMMMMMMMMM:----:+hmMMMMMMmdds
# -dddMMMMMm/////////////.-mMMMMMMMd`-///:-.-sNNdy/-.--------sMMMMMMMNmhmMMMMMMMMMM:-------:yMMMMMmddo
# `dddNMMMMN////////////-.mMMMMMMMM/-::--..://----:/:--------sMMMMMMMMMh:+ymMMMMMMM:--------yMMMMMmdd+
#  dddNMMMMM///////////-`hMMMMMMMNo++oosdmmdy+:.-///:--------sMMMMMMMMMh---:/sdNMMM:--------dMMMMMmdd:
#  yddNMMMMMo/////////:`yMMMMMMMM/`::::-.oMMMMNd:.//:--------sMMMMMMMMMh------:/ohN:--------NMMMMNddd.
#  oddmMMMMMy////////:`oMMMMMMMMo`://///: mMMMMMd :/:--------sMMMMMMMMMh----------/do/-----/MMMMMNddd
#  :ddmMMMMMm////////`/MMMMMMMMs`://////-`mMMMMMh :/:--------sMMMMMMMMMh-----------MMNho:--oMMMMMmdds
#  `dddNMMMMM+//////.:NMMMMMMMh`://///:-.yMMMMMd.-//:--------sMMMMMMMMMh-----------MMMMMmh+dMMMMMmdd/
#   sddmMMMMMy/////.-NMMMMMMMd`.------:omMMMNh+.-///:--------sMMMMMMMMMh-----------MMMMMMMMMMMMMNddd`
#   :ddmMMMMMm////-`hmmmmmmmmsooooooshddhyo/--://///:--------sMMMMMMMMMh-----------MMMMMMMMMMMMMmdds
#   `hddNMMMMMo//:..----------------------::////////:--------sMMMMMMMMMh-----------MMMMMMMMMMMMMmdd:
#    +ddmMMMMMd:::::::::::::::::::::://+++++++++++++:::::::::smmmmmmmmmy:::::::::::mmmmmmNMMMMMNddh
#    `dddNMMMMM:                   :oo..+yyyyyyyyyyy+///////////////////////////////////+NMMMMMmdd/
#     +ddmMMMMMd`                 `yyy   yyyyyyyyyyy+////::::----------------:::////////yMMMMMmddh`
#     `hddNMMMMMo                 .yyy   yyyyyyyyyyy/----:/+osyhhdddmmmmmddhyo/:--:////+NMMMMNmdd:
#      :ddmNMMMMN-           -::::/yyy   +++++oyyyyy+oyhhdddhhyyysssyyhdmNMMMMMNms-.///mMMMMMmdds
#       oddmMMMMMm.         /yyyyyyyyy         +yyyy/:----.``.:+osy-`--.--/dMMMMMMm`-/hMMMMMNddh`
#       `hddmMMMMMh`        /yyyyyyyyy         +yyyy+///:.-odNMMMMs`://///..MMMMMMh`:yMMMMMNmdd:
#        .dddNMMMMMy`       `-::::/yyy   /++++oyyyyy+//-.sNMMMMMMh`-/////:`/MMMMmo.-sMMMMMNmdd+
#         :ddmNMMMMMy`            .yyy   yyyyyyyyyyy+/-.dMMMMMMMm..::::---smmhs/.-:sNMMMMMmddo
#          /ddmNMMMMMy`           .yyy   yyyyyyyyyyy+-`dMMMMMMMMo://:--.:/:-.--://sMMMMMMmdds`
#           /ddmNMMMMMh.          .yyy   yyyyyyyyyyy/`yMMMMMMMMo//++ohNNmdy+-.://yMMMMMMmdds`
#            /ddmNMMMMMmo+++++++++oyyy   -----------`oMMMMMMMMo`:::::.:NMMMMNo`/hMMMMMNmdds`
#             :dddNMMMMMMdyyyyyyyyyyys``````````````+MMMMMMMMs`:////// yMMMMMM-dMMMMMNmddo`
#              -hddmMMMMMMy-..........osssssssssssssNMMMMMMMh`-//////-.NMMMMMMmMMMMMNmdd+
#               .yddmNMMMMMd-``````  `yyysssssssssssNMMMMMMd`.//////-`hMMMMMMMMMMMMmddh:
#                `oddmNMMMMMNhyssso  `yyy`          dMMMMMm..//////:`oMMMMMMMMMMMNmddy.
#                  :hddmMMMMMMNhyyo  `yyy`          ymmmmd-`://///:`:mmmNMMMMMMMNmddo`
#                   .sddmNMMMMMMmho  `yyy`          .......://////-...-+mMMMMMNmddh:
#                     /hddmNMMMMMNh` `yyy.....`     :////////////////omMMMMMMNmddo`
#                      .sddmNMMMMMMm/.yyyyyyyyy-    ://////////////odMMMMMMNmddh:
#                        -yddmNMMMMMMmdyyyyyyyy/   `o////////////odMMMMMMNmddd+`
#                          /hddmNMMMMMMNdo++++/`/  /m//oo//////sdMMMMMMNmdddo.
#                           `+hddmNMMMMMMNs- .` ds`hM+sN+/+/+ymMMMMMMNmmdds.
#                             `+hddmNMMMMMMMdsmhdMdMMmMMdNddNMMMMMMNmddds-
#                               `/hddmNMMMMMMMMMMMMMMMMMMMMMMMMMMNmdddo.
#                                  :ydddmNMMMMMMMMMMMMMMMMMMMMNmmddh+.
#                                    -odddmmNMMMMMMMMMMMMMMMNmdddy:`
#                                      `:ydddmNNMMMMMMMMMNmdddh+.
#                                         ./ydddmmNMMNNmdddho-
#                                            `/sddddmdddy+-
#                                                -+yho:`
#

library(caret)
library(ggplot2)
library(hrbrthemes)
library(pastecs)
require(dplyr)
library(pander)
library(GGally)
library(Hmisc)
library(stats)
library(pROC)
library(useful)
library(factoextra)
library(forcats)
library(stringr)
library(tidyr)
library(zoo)
library(xts)
library(ppcor)
library(GGally)
library(pROC)
```

### Helper Functions 

```{r}
missile_capabilities <- function(missile_type) {
  # This function will help ID North Korea missiles capabilities 
  # @missile_type: given a missile type
  icbm <- as.data.frame( nk_missiles %>% filter( Missile.Type == missile_type) )[c("Missile.Type", "Missile.Name","Apogee")]  
  colnames(icbm) <- c("Missile Name", "Missile Type", "Apogee")
  return(as.vector(unique(icbm)))
}

variable_summary <- function(var_a, var_b) { 
  # Helper function to return the P-Value and Confident Intervals 
  # @var_a: given a vector 
  # @var_b: given a vector 
  # @return: data frame with p_value and confidence interval attributes 
  results <- cor.test(var_a, var_b, use = "complete.obs", method = "pearson")  
  
  return( data.frame(p_value=results$p.value, ci=toString( paste(results$conf.int)) ))
}

calculate_auc <- function(df_training, df_labels) { 
  # Helper function to calculate the are under the curve for the training data
  # @df_training: given training dataset 
  # @df_labels: given the training labels
  # @return: auc score 
  set.seed(100)
  return(as.numeric(roc(df_labels, ifelse( predict(train(df_training, df_labels, method='rpart')) == "Success", 1, 0  ) )$auc))
}

fill_landing_location <- function(location) { 
  # Helper function to label empty string with Unknown
  # @location: given the string location
  # @return: a string location attribute
  if (location == "") {
    return("Unknown")
  } else {
    return(toString(location))
  } 
}
```

### North Korea Missile Tests

```{r}
nk_missiles <- read.csv("./north_korea_missile_test_database.csv")
pandoc.table(head(nk_missiles, 5), "Table 1.1.1: North Korean Missles Dataset from https://www.nti.org", style="grid")
```

### Refference: Data Types 

```{r}
str(nk_missiles)
```

# Data Conversion

```{r}
# Keep the missiles range in Km (Kilometer)
nk_missiles$Apogee <- as.vector( as.numeric( str_extract(nk_missiles$Apogee, "[0-9]+")))
nk_missiles$`Distance Travelled` <- as.vector( as.numeric( str_extract(nk_missiles$Distance.Travelled, "[0-9]+")))
nk_missiles$`Facility Latitude` <- as.vector(as.numeric( nk_missiles$Facility.Latitude)) 
nk_missiles$`Facility Longitude` <- as.vector(as.numeric( nk_missiles$Facility.Longitude)) 

# Add new column YEAR
nk_missiles$YEAR <- as.vector( strftime(nk_missiles$Date, "%Y"))
nk_missiles$DATE <- as.POSIXct(nk_missiles$Date)
nk_missiles$Landing.Location <- sapply(nk_missiles$Landing.Location, fill_landing_location)
```

# Data Exploration 

### North Korea Missile Testing and Developments
```{r}
missile_productions <- arrange( data.frame( table( nk_missiles[c("YEAR","Missile.Type","Test.Outcome")] )) %>% filter(Freq != 0 ), YEAR )
missile_productions <- missile_productions[c("YEAR", "Missile.Type", "Freq", "Test.Outcome")]
colnames(missile_productions) <- c("Year", "Missile Types", "Number of Testing and Developemnts", "Test Outcome" )
pandoc.table( missile_productions, style="grid", "Figure A.1: North Korea missle testing and developments")
```

### Missiles in North Korea Arsenals 

- **Figure 1.1** shows that North Korea appears to have lots of SRBM (Short Range Ballistic Missile) in their possesion.

```{r}

# North Korea Missile Types
missiles_types <- data.frame( table(nk_missiles$Missile.Type)) 
colnames(missiles_types) <- c("Missile Types","Freq")
missiles_types %>% mutate( name = fct_reorder(`Missile Types`, Freq)) %>% ggplot(aes(x=name,y=Freq,fill=`Missile Types`)) + 
               geom_bar(aes(color=`Missile Types`),stat="identity") +
               labs(title="Figure 1.1.1: Missiles in North Korea Arsenals", y="Number of Missiles", x="Types of Missiles")
               facet_grid()
               
# North Korea Missile Names             
missiles_names <- data.frame( table(nk_missiles$Missile.Name)) 
colnames(missiles_names) <- c("Missile Names","Freq")
missiles_names %>% mutate( name = fct_reorder(`Missile Names`, Freq)) %>% ggplot(aes(x=name,y=Freq,fill=`Missile Names`)) + 
               geom_bar(stat="identity") +
               labs(title="Figure 1.1.2: Missiles in North Korea Arsenals", y="Number of Missiles", x="Missiles Names") +
               scale_y_continuous( limits = c(0,28)) +
               coord_flip() + 
               facet_grid() 

```


```{r}
missile_range <- aggregate(nk_missiles[c('Apogee')], list(Type=nk_missiles$Missile.Type,Name=nk_missiles$Missile.Name), FUN = "max") 
pandoc.table(drop_na(missile_range), style="grid" ,"Table 1.1.2: North Korea Missile Maximum Range" )

drop_na(missile_range) %>% mutate( Missiles = fct_reorder(Name,  Apogee, .desc = FALSE)) %>% ggplot(aes(x=Missiles,y=Apogee, fill=Missiles)) + 
                  geom_bar(stat="identity") + 
                  coord_flip() + 
                  labs(title="Figure 1.2.1: North Korea Missile Maximum Range", x="Missile Names", y="Apogee (Km)")
```

### Missile Tests at North Korea Testing Facilities 
```{r fig.width=20, fig.height=12}
north_korea_tests_facilities <- nk_missiles[c('Facility.Location', 'Facility.Name', 'Missile.Type','Missile.Name')] %>% count( Facility.Location, Facility.Name, Missile.Type, Missile.Name) %>% mutate(Facilities=fct_reorder(Facility.Name, n, .desc = FALSE))
pandoc.table(arrange(north_korea_tests_facilities,n)[,1:5],style='grid', "Table 1.1.3")

north_korea_tests_facilities %>% ggplot(aes(x=Facilities, y=n, fill=Facilities)) + 
                                 geom_bar(stat = "identity", width = 0.4) + 
                                 labs(title="Figure 1.2.2: Number of Missile Tests conducted at North Korea Testing Facilities", y="Number of Tests", x="Testing Facilities") + 
                                 coord_flip() + 
                                 facet_grid()
```

### Missiles distance travelled distributions 
  
  * Missile distance travelled is positively skew and the normal Quantile-Quantile Plots shows that the data values deviating away from the diagonal. The distribution graph seems to suggest that missile distance travelled were much more clustered around the low end of the scale. Since this is an overall distribution of missile distance travelled, the skew might occur because some missile types can travel further distance than the others (e.g. ICBM can be fired from distance close to 1000 Km).  

```{r}
nk_missiles %>% ggplot(aes(`Distance Travelled`)) + 
                geom_histogram(aes(y=..density..), fill = "salmon", color="#04FD1F", bins=10) + labs(title="Figure 1.3.1: Missle Distance Travelled", x="Distance Travelled (Km)" , y="Frequency") + 
                stat_function(fun = dnorm, args = list(mean = mean(nk_missiles$`Distance Travelled`, na.rm = TRUE ), sd = sd(nk_missiles$`Distance Travelled`, na.rm = TRUE) ), colour="black", size=1 ) + geom_vline(xintercept= mean(nk_missiles$`Distance Travelled`, na.rm = TRUE), color='black') + geom_vline(xintercept= median(nk_missiles$`Distance Travelled`, na.rm = TRUE), color='red') 

qqnorm(nk_missiles$`Distance Travelled`, plot.it = TRUE, xlab = "Theoretical", ylab = "Sample") 
qqline(nk_missiles$`Distance Travelled`, datax = FALSE, distribution = qnorm, probs = c(0.25, 0.75) , qtype= 7)
```

### Missiles Apogee distributions 

  - Missile Apogee is positively skew and the normal Quantile-Quantile Plots shows that the data values deviating away from the diagonal. The distribution graph seems to suggest that missile apogee were much more clustered around the low end of the scale. Since this is an overall distribution of missile apogee, the skew might occur because some missile types can travel further distance than the others (e.g. ICBM can travels up to 4475 Km). 
  
```{r}
nk_missiles %>% ggplot(aes(Apogee)) + 
                geom_histogram(aes(y=..density..), fill = "salmon", color="#04FD1F", bins=10) + labs(title="Figure 1.3.1: Missles Apogee", x="Apogee (Km)" , y="Frequency") + 
                stat_function(fun = dnorm, args = list(mean = mean(nk_missiles$Apogee, na.rm = TRUE ), sd = sd(nk_missiles$Apogee, na.rm = TRUE) ), colour="black", size=1 ) + geom_vline(xintercept= mean(nk_missiles$Apogee, na.rm = TRUE), color='black') + geom_vline(xintercept= median(nk_missiles$Apogee, na.rm = TRUE), color='red') 

qqnorm(nk_missiles$Apogee, plot.it = TRUE, xlab = "Theoretical", ylab = "Sample") 
qqline(nk_missiles$Apogee, datax = FALSE, distribution = qnorm, probs = c(0.25, 0.75) , qtype= 7)
```

### North Korea overall missile tests from **1984** to **2019**

  - Since 1984 to 2020, North Korea has **118** success, 28 failures, and 3 unknown missile tests. 

```{r}
overall_missile_tests <- data.frame(table( nk_missiles$Test.Outcome) )
overall_missile_tests$fraction <- overall_missile_tests$Freq / sum(overall_missile_tests$Freq)
overall_missile_tests$ymax <- cumsum(overall_missile_tests$fraction)
overall_missile_tests$ymin <- c(0, head(overall_missile_tests$ymax, n=-1) )
overall_missile_tests$labelPosition <-   data.frame( overall_missile_tests %>% mutate(labelPosition=(ymax + ymin)/2))$labelPosition
overall_missile_tests <- overall_missile_tests %>% mutate(label = paste(Var1,":",Freq))

overall_missile_tests %>% ggplot(aes(ymax=ymax, ymin=ymin, xmax=4, xmin=3, fill=Var1)) +
  geom_rect() +
  geom_text( x=2, aes(y=labelPosition, label=label, color=Var1), size=6) + # x here controls label position (inner / outer)
  scale_fill_brewer(palette=3) +
  scale_color_brewer(palette=3) +
  coord_polar(theta="y") +
  xlim(c(-1, 4)) +
  theme_void() +
  theme(legend.position = "none") +
  labs(title="Figure 1.4.1: North Korea Missile Tests from 1984 to 2019")

# Confirmed success missile test apogee 
missile_success_outcome <- data.frame( nk_missiles %>% filter(`Confirmation.Status` == "Confirmed" & `Test.Outcome` == "Success" & Apogee > 0))[c('Missile.Type','Missile.Name', 'Apogee', 'Distance.Travelled.1')]
missile_tests_apogee <- aggregate(missile_success_outcome$Apogee, list(Type=missile_success_outcome$Missile.Type, Name=missile_success_outcome$Missile.Name), FUN = "mean") %>% mutate( Missiles = fct_reorder(Name,x))

# Explore confirmed success missile tests
pandoc.table(missile_tests_apogee[c("Missiles", "x")], style='grid', "Table 1.1.4 Successful Missile Tests Apogee")
missile_tests_apogee %>% ggplot(aes(x=Missiles, y=x,fill=Missiles)) + geom_bar(stat="identity") + labs(title="Figure 1.4.2: Confirmed successful missile tests apogee", x="Missile Names", y="Apogee (Km)") + coord_flip()
# Confirmed success missile test distance travelled
missile_tests_distance_travelled <- aggregate(missile_success_outcome$Distance.Travelled.1, list(Type=missile_success_outcome$Missile.Type, Name=missile_success_outcome$Missile.Name), FUN = "mean") %>% mutate( Missiles = fct_reorder(Name,x))
drop_na(missile_tests_distance_travelled) %>% ggplot(aes(x=Missiles, y=x,fill=Missiles)) + geom_bar(stat="identity") + labs(title="Figure 1.4.3: Confirmed successful test missile travel distance", x="Missile Names", y="Distance Travelled (Km)") + coord_flip()
```

### North Korea Sucessful Missile Tests 

- North Korea has many successful missile tests in 2019

```{r}
success_years<- data.frame(nk_missiles %>% filter(Test.Outcome == 'Success'))
nk_success_years <- c() 
for (year in success_years$Date ) { 
  nk_success_years <- c(str_split(year,'-')[[1]][1],nk_success_years ) 
}
data.frame(table( as.vector(nk_success_years)) ) %>% mutate(Years = fct_reorder(Var1, Freq)) %>% ggplot(aes(x=Years,y=Freq,fill=Years)) +
                                                    geom_bar(stat="identity") + 
                                                    labs(title="Figure 1.5: Successful missile tests from 1984 to 2020", x="Years", y="Number of successful missiled tests")
```

### North Korea Failed Missile Tests 

- North Korea has many failure missile tests in 2016

```{r}
failure_years<- data.frame(nk_missiles %>% filter(Test.Outcome == 'Failure'))
nk_failure_years <- c() 
for (year in failure_years$Date ) { 
  nk_failure_years <- c(str_split(year,'-')[[1]][1],nk_failure_years ) 
}
data.frame(table( as.vector(nk_failure_years)) ) %>% mutate(Years = fct_reorder(Var1, Freq)) %>% ggplot(aes(x=Years,y=Freq,fill=Years)) +
                                                    geom_bar(stat="identity") + 
                                                    labs(title="Figure 1.6.1: Failure missile tests from 1984 to 2020", x="Years", y="Number of failure tissile tests")
```

### North Korea Missiles Tests Landing Location 
```{r}
missile_tests_landing_location <- arrange(group_by(nk_missiles, Missile.Type, Landing.Location ) %>% count(Missile.Type, Landing.Location), desc(n) )
colnames(missile_tests_landing_location) <- c("Missile Tests", "Landing Locations", "Frequency")
pandoc.table(missile_tests_landing_location, "Table 1.1.5: Frequency of North Korea's missiles tests landing location", style='grid')
```

### North Korea Missile Successful Testing and Developments in 2014 
```{r}
nk_missile_test_2014 <- data.frame( data.frame(nk_missiles %>% filter(YEAR == '2014' & Test.Outcome == 'Success') )[c('Missile.Type', 'Missile.Name', 'Facility.Location', 'Facility.Name')] %>% count(Missile.Type, Missile.Name, Facility.Location, Facility.Name) )

nk_missile_test_2014 %>% mutate(Missiles=fct_reorder(Missile.Type, n)) %>% ggplot(aes(x=Missiles, y=n,fill=Missiles)) +
                                                                           geom_bar(stat = "identity", width = 0.4) + 
                                                                           labs(title="Figure 1.7.1: Missile types tested in 2014 under Kim Jon Un" , x="Missile Types", y="Number of Missile Tests") +
                                                                           facet_grid()

nk_missile_test_2014 %>% mutate(Missiles=fct_reorder(Missile.Name, n)) %>% ggplot(aes(x=Missiles, y=n,fill=Missiles)) +
                                                                           geom_bar(stat = "identity", width = 0.4) + 
                                                                           labs(title="Figure 1.7.2: Missile names tested in 2014 under Kim Jon Un" , x="Missile Types", y="Number of Missile Tests") +
                                                                           facet_grid()

pandoc.table(nk_missile_test_2014, "Table 1.1.6: North Korea Missile Successful Testing and Developments in 2014 ", style='grid')
```
### North Korea Missile Development and Testing in 2016 

  - In 2016, North Korea has conducted a total of 24 missile tests, which include:
    - 7 failures and 1 successful tests of **Musudan** Intermediate-range ballistic missile.
    - 3 successful tests of **ER Scud** Medium range ballastic missile.
    - 3 successful and 2 failures tests of **Nodong** Medium rangen ballastic missile. 
    - 1 failure and 2 successful tests of **Pukguksong-1** Submarine Launched Ballistic Missile. 
    - 1 succes test of **Unha-3** Satelite Launched Vehicle missile. 
    - 4 successful of **Scud-C** Short-range ballistic missile.

  - *Table 2.1.2* shows the brief missile tests summary conducted by the North Korea in 2016
  
  
  
```{r}
# Number of missile tests in 2016
missile_tests_2016 <- data.frame(group_by( nk_missiles %>% filter(YEAR == '2016') , Missile.Type, Missile.Name ) )[c('Missile.Type', 'Missile.Name')] [c("Missile.Type", "Missile.Name")] %>% count(Missile.Type, Missile.Name)

pandoc.table(missile_tests_2016, style='grid', "Table 2.1.1: North Korea Missile Test in 2016")

missile_tests_2016 %>% mutate(Missiles = fct_reorder(Missile.Name, n)) %>% ggplot(aes(x=Missiles, y=n, fill=Missiles)) + 
                                                                           geom_histogram(stat = "identity") + 
                                                                           labs(title="Figure 1.7.1: Number of missile test conducted by the North Korea in 2016", y="Number of Tests") + 
                                                                           facet_grid() 

# Missile Tests Outcome in 2016 
missile_test_outcome_2016 <- data.frame(group_by( nk_missiles %>% filter(YEAR == '2016') , Missile.Type, Missile.Name ) )[c('Missile.Type', 'Missile.Name', 'Test.Outcome')] [c("Missile.Type", "Missile.Name", "Test.Outcome")]  %>% count(Missile.Type, Missile.Name, Test.Outcome)

pandoc.table(missile_tests_2016, style='grid', "Table 2.1.1: North Korea Missile Test in 2016")

# Missile types in 2016
data.frame(nk_missiles %>% filter(YEAR == '2016') )[c('Missile.Type')] %>% count(Missile.Type) %>% mutate(Missiles = fct_reorder(Missile.Type, n)) %>% ggplot(aes(x=Missiles, y=n,fill=Missiles)) + 
                                                                                                                                                     geom_histogram(stat="identity") +  
                                                                                                                                                     labs(title="Figure 1.7.2: Missile Types in 2016", y="Number of Missiles") + 
                                                                                                                                                     facet_grid()
# Missile Tests Summary in 2016
summary_missile_tests_2016 <- data.frame(group_by( nk_missiles %>% filter(YEAR == '2016') , Missile.Type, Missile.Name ) )[c('Date', 'Launch.Time..UTC.', 'Missile.Type', 'Missile.Name', 'Facility.Name' , 'Facility.Location', 'Facility.Location' , 'Landing.Location', 'Test.Outcome')] %>% count(Date,`Launch.Time..UTC.`, Missile.Type, Missile.Name, Facility.Name , Facility.Location, Facility.Location , Landing.Location, Test.Outcome) 
pandoc.table(summary_missile_tests_2016, style='grid', "Table 2.1.2: North Korea Missile Test outcome in 2016")

# Explore IRBM in 2016
```

### North Korea Missile Development and Testing in 2019.

  - North Korea has carried out 22 successful tests in 2019, including testing and development of **8 KN-23**, **4 KN-24** , and **4 KN-25** short range ballistic missiles. Also  and one Pukguksong-3 submarine launched ballistic missile. 
  
```{r}
missile_tests_2019 <- data.frame(table( data.frame( nk_missiles %>% filter(YEAR == '2019') )[c('Missile.Type')] ))  %>% mutate(Missiles=fct_reorder(Var1, Freq)) %>% filter(Freq > 0) 

pandoc.table(missile_tests_2019[c("Missiles","Freq")], style="grid" ,"Table 2.2.1: Missile Development in 2019" )
missile_tests_2019  %>% ggplot(aes(x=Missiles,y=Freq,fill=Missiles)) +
                                              geom_bar(stat="identity", width = 0.5) + 
                                              coord_flip() +
                                              labs(title="Figure 1.8: North Korea Missiles Development in 2019", x="Missiles", y="Number of Missiled Tests")

drop_na( data.frame( nk_missiles %>% filter(Missile.Type == 'SRBM' & YEAR == '2019') )[c("DATE", "Apogee")] ) %>% ggplot(aes(x=DATE, y=Apogee)) + 
                                                                                                                  geom_line(color="red", linetype=2) + 
                                                                                                                  geom_point() + 
                                                                                                                  labs(title="North Korea SRBM Missile Development in 2019", x="2019", y="Apogee (Km)") + scale_x_datetime(limits = as.POSIXct(strptime(c("2019-05-09","2019-11-28"), format = "%Y-%m-%d")) , breaks = scales::date_breaks("1 month"), labels = scales::date_format("%Y-%m-%d"))

# Types of missile developed by North Korea in 2019 
missile_types_df <- data.frame( group_by( data.frame( nk_missiles %>% filter(YEAR == '2019')) , Missile.Type, Missile.Name )[c('Missile.Type', 'Missile.Name')]  %>% count(Missile.Type, Missile.Name) )
pandoc.table(missile_types_df, style="grid", "Table 2.2.2: Missile Types and Names developed by North Korea in 2019")

# Summary of missile tests conducted in 2019 by the North Korea

missile_test_summary <- data.frame(nk_missiles %>% filter(YEAR == 2019))[c('Missile.Type' ,'Missile.Name', 'Apogee', 'Distance.Travelled', 'Facility.Location', 'Confirmation.Status' ,'Landing.Location','Test.Outcome')]
missile_test_summary$Apogee <- paste(missile_test_summary$Apogee, "Km")
pandoc.table(missile_test_summary, style="grid", "Table 2.3: Summary of Missile tests conducted by the North Korea in 2019 ")
```

### North Korea ICBM Missiles Capabilities 

```{r}
icbm <- missile_capabilities("ICBM")
icbm <-  aggregate(icbm[c('Apogee')], list(Type=icbm$`Missile Type`,Name=icbm$`Missile Name`), FUN = "mean") 
pandoc.table(icbm, style="grid", "Table 3.1: North Korea ICBM")

icbm %>% ggplot(aes(x=Type, y=Apogee,fill=Type)) +
         geom_bar(stat="identity", width = 0.3) + 
         labs(title = "Figure 2.1: ICBM Range", x="Missile Type", y="Apogee (Km)")
```

### North Korea IRBM Missiles Capabilities 

```{r}
irbm <- drop_na(missile_capabilities("IRBM"))
irbm <- aggregate(irbm[c('Apogee')], list(Type=irbm$`Missile Type`,Name=irbm$`Missile Name`), FUN = "mean")
pandoc.table(irbm, style="grid", "Table 3.2: North Korea IRBM")

irbm %>% ggplot(aes(x=Type, y=Apogee,fill=Type)) +
         geom_bar(stat="identity", width = 0.3) + 
         labs(title = "Figure 2.2: IRBM Range", x="Missile Type", y="Apogee (Km)")
```

### North Korea SLBM Missiles Capabilities 

```{r}
slbm <- drop_na(missile_capabilities("SLBM"))
pandoc.table( slbm, style="grid", "Table 3.3: North Korea SLBM")

slbm %>% ggplot(aes(x=`Missile Type`, y=Apogee,fill=`Missile Type`)) +
         geom_bar(stat="identity", width = 0.3) + 
         labs(title = "Figure 2.3: SLBM Range", x="Missile Type", y="Apogee (Km)")
```

### North Korea SLV Missiles Capabilities 

```{r}
slv <- drop_na(missile_capabilities("SLV"))
slv <- aggregate(slv[c('Apogee')], list(Type=slv$`Missile Type`,Name=slv$`Missile Name`), FUN = "mean")
pandoc.table(slv, style="grid", "Table 3.4: North Korea SLV")
slv %>% ggplot(aes(x=Type, y=Apogee,fill=Type)) +
         geom_bar(stat="identity", width = 0.3) + 
         labs(title = "Figure 2.4: SLV Range", x="Missile Type", y="Apogee (Km)")
```

### North Korea MRBM Missiles Capabilities 

```{r}
mrbm <- drop_na(missile_capabilities("MRBM"))
mrbm <- aggregate(mrbm[c('Apogee')], list(Type=mrbm$`Missile Type`,Name=mrbm$`Missile Name`), FUN = "mean")
pandoc.table(mrbm, style="grid", "Table 3.5: North Korea MRBM")
mrbm %>% mutate(Missiles = fct_reorder(Type, Apogee)) %>% ggplot(aes(x=Missiles, y=Apogee,fill=Missiles)) +
         geom_bar(stat="identity", width = 0.3) + 
         labs(title = "Figure 2.5.1: MRBM Range", x="Missile Type", y="Apogee (Km)")

drop_na( data.frame( nk_missiles %>% filter(Missile.Type == 'MRBM'))[c('DATE', 'Apogee')] ) %>% ggplot(aes(x=DATE,y=Apogee)) + geom_line() + geom_point(size=2, color='red') + labs(title="Figure 2.5.2: MRBM Missile Apogee from 1984 to 2020", y="Apogee (Km)", x="Testing Dates") + scale_x_datetime(limits = as.POSIXct(strptime(c("1991","2020"), format = "%Y")) , breaks = scales::date_breaks("2 year"), labels = scales::date_format("%Y"))
```

### North Korea SRBM Missiles Capabilities 

```{r}
srbm <- drop_na(missile_capabilities("SRBM"))
srbm <- aggregate(srbm[c('Apogee')], list(Type=srbm$`Missile Type`,Name=srbm$`Missile Name`), FUN = "mean")
pandoc.table(srbm, style="grid", "Table 3.6: North Korea SRBM")
srbm %>% mutate(Missiles = fct_reorder(Type, Apogee)) %>% ggplot(aes(x=Missiles, y=Apogee,fill=Missiles)) +
         geom_bar(stat="identity", width = 0.3) + 
         labs(title = "Figure 2.6.1: SRBM Range", x="Missile Type", y="Apogee (Km)")

# North Korea SRBM Development (Since North Korea has so many of them)
drop_na( data.frame( nk_missiles %>% filter(Missile.Type == 'SRBM') )[c('DATE', 'Apogee')] ) %>% ggplot(aes(x=DATE, y=Apogee)) + 
                                                                                                 geom_point(color='black', size=2) + geom_line(linetype=2, color='red') +
                                                                                                 labs(title="Figure 2.6.2: North Korea SRBM Missile Development from 1984 to 2020", x="Years of Testing and Developments", y="Apogee (Km)") + scale_x_datetime(limits = as.POSIXct(strptime(c("1984","2020"), format = "%Y")) , breaks = scales::date_breaks("2 year"), labels = scales::date_format("%Y"))

# North Korea SRBM Apogee Range from 2016 to 2019 
drop_na( data.frame( nk_missiles %>% filter(Missile.Type == 'SRBM' & (YEAR == '2016' | YEAR == '2017' | YEAR == '2018' | YEAR == '2019' | YEAR == '2020')) )[c('DATE', 'Apogee')] ) %>% ggplot(aes(x=DATE, y=Apogee)) + 
                                                                                                 geom_point(color='black', size=2) + geom_line(linetype=2, color='red') +
                                                                                                 labs(title="Figure 2.6.3: North Korea SRBM Missile Development from 2016 to 2020", x="Years of Testing and Developments", y="Apogee (Km)") + scale_x_datetime(limits = as.POSIXct(strptime(c("2016","2020"), format = "%Y")) , breaks = scales::date_breaks("1 year"), labels = scales::date_format("%Y"))
```

# Variables Analysis for Classification
  * **Exogenous Variables**: Apogee, Confirmation.Status, Distance Travelled, Facility.Name, Facility.Type
  * **Endogenous Variables**: Test.Outcome 
  
  **Summary** 
  
  * **Figure 3.1.1** shows positive correlation between the Apogee vs the Test.Outcome variables 
  * **Figure 3.1.2** shows negative correlation between the Confirmation.Status vs the Test.Outcome variables 
  * **Figure 3.1.3** shows positive correlation between the Distance Travelled  vs the Test.Outcome variables 
  * **Figure 3.1.4** shows negative correlation between the Facility.Name vs the Test.Outcome variables 
  * **Figure 3.1.5** shows negative correlation between the Facility.Location vs the Test.Outcome variables 
  * **Figure 3.1.6** shows the heatmap of the variable correlations
  
  **Variable Relationships**
  
  * **Apogee** shares **1.019%** of the variability in Test.Outcome
  * **Confirmation.Status** shares **0.6124%** of the variability in Test.Outcome
  * **Distance.Travelled**  shares **0.1004%**   of the variability in Test.Outcome 
  * **Facility.Name** shares **17.1%** of the variability in Test.Outcome
  * **Facility.Location** shares **0.02649%** of the variability in Test.Outcome
  * **Missile.Type** shares **11.1%** of the variability in Test.Outcome 

```{r}
# Convert categories into numeric values 
classification_model_missiles <- nk_missiles
classification_model_missiles$Apogee <- na.fill(classification_model_missiles$Apogee, median(classification_model_missiles$Apogee, na.rm = TRUE))
classification_model_missiles$Confirmation.Status <- ifelse( classification_model_missiles$Confirmation.Status == "Confirmed", 1, 0 )
classification_model_missiles$Test.Outcome <- as.vector( ifelse( nk_missiles$Test.Outcome == "Success", 1, 0) )
classification_model_missiles$`Distance Travelled` <- na.fill( classification_model_missiles$`Distance Travelled`, median(classification_model_missiles$`Distance Travelled`, na.rm = TRUE) )
classification_model_missiles$Facility.Name <- as.numeric(classification_model_missiles$Facility.Name)
classification_model_missiles$Missile.Type <- as.numeric(classification_model_missiles$Missile.Type)
classification_model_missiles$Facility.Location <- as.numeric(classification_model_missiles$Facility.Location)

feature_columns <- c("Apogee","Confirmation.Status","Distance Travelled", "Facility.Name", "Facility.Location", "Missile.Type" ,"Test.Outcome")
# Apogee vs Missile Test Outcome 
classification_model_missiles %>% ggplot(aes(x=Apogee, y=Test.Outcome)) +
                                  geom_point() +  
                                  geom_smooth(method = "lm") + 
                                  labs(title="Figure 3.1.1: Apogee vs Missile Test Outcome") + 
                                  facet_grid()

# Confirmation.Status vs Missile Test Outcome
classification_model_missiles %>% ggplot(aes(x=Confirmation.Status, y=Test.Outcome)) +
                                  geom_point() +  
                                  geom_smooth(method = "lm") + 
                                  labs(title="Figure 3.1.2: Confirmation Status vs Missile Test Outcome") + 
                                  facet_grid()

# Distance Travelled vs Missile Test Outcome
classification_model_missiles %>% ggplot(aes(x=`Distance Travelled`, y=Test.Outcome)) +
                                  geom_point() +  
                                  geom_smooth(method = "lm") + 
                                  labs(title="Figure 3.1.3: Distance Travelled vs Missile Test Outcome") + 
                                  facet_grid()

# Facility Name vs Missile Test Outcome
classification_model_missiles %>% ggplot(aes(x=Facility.Name, y=Test.Outcome)) +
                                  geom_point() +  
                                  geom_smooth(method = "lm") + 
                                  labs(title="Figure 3.1.4: Facility.Name vs Missile Test Outcome") + 
                                  facet_grid()

# Facility.Location vs Missile Test Outcome
classification_model_missiles %>% ggplot(aes(x=Facility.Location, y=Test.Outcome)) +
                                  geom_point() +  
                                  geom_smooth(method = "lm") + 
                                  labs(title="Figure 3.1.5: Facility.Location vs Missile Test Outcome") + 
                                  facet_grid()

# Correlation between feature columns 
ggcorr(classification_model_missiles[feature_columns] , label = TRUE) + labs("Figure 3.1.6: Correlations")

apogee_summary <- variable_summary(classification_model_missiles$Apogee, classification_model_missiles$Test.Outcome)
confirmed_status_summary <-  variable_summary(classification_model_missiles$Confirmation.Status, classification_model_missiles$Test.Outcome)
distanced_travelled_summary <- variable_summary(classification_model_missiles$Confirmation.Status, classification_model_missiles$Test.Outcome)
facility_name_summary <-  variable_summary(classification_model_missiles$Facility.Name, classification_model_missiles$Test.Outcome) 
facility_location_summary <-  variable_summary(classification_model_missiles$Facility.Location, classification_model_missiles$Test.Outcome) 
missile_type_summary <-  variable_summary(classification_model_missiles$Missile.Type, classification_model_missiles$Test.Outcome) 

p_values <- c(apogee_summary$p_value, confirmed_status_summary$p_value, distanced_travelled_summary$p_value, facility_name_summary$p_value, facility_location_summary$p_value, missile_type_summary$p_value)
conf_int <- c(toString(apogee_summary$ci), toString(confirmed_status_summary$ci), toString(distanced_travelled_summary$ci), toString(facility_name_summary$ci), toString(facility_location_summary$ci), toString(missile_type_summary$ci))

# Correlation and Coefficient Determination 
vars_correlations <- cor( classification_model_missiles[feature_columns] )
variables_summaries<- data.frame(CORRELATION=vars_correlations, RSquared=cor( classification_model_missiles[feature_columns] ) ^ 2 * 100) 
variables_summaries <- slice(variables_summaries[,c(7,14)], c(1:6))

variables_summaries$PVALUES=p_values
variables_summaries$CI=conf_int
rownames(variables_summaries)<- colnames( vars_correlations )[c(1:6)]
pandoc.table(variables_summaries, style='grid', "Table 4.1: Variables Summary")

```
# North Korea's Missile Test Classification

```{r}

set.seed(1000)
classification_model_missiles$Test.Outcome <- ifelse(classification_model_missiles$Test.Outcome == 1, "Success", "Failure" )
samples <- createDataPartition(classification_model_missiles$Test.Outcome, p=0.8, list=FALSE)
clf_training <- classification_model_missiles[samples,]
clf_testing <- classification_model_missiles[-samples,]
```

# Classify North Korea Missile's Test as Successful or Failure using:
  * **Prediction Model One**:  Missile Types and Apogee 
  * **Prediction Model Two**:  Missile Types, Facility Name, and Apogee
  * **Prediction Model Three**: Missile Type, Facility Name, Facility Location, Apogee
  * **Prediction Model Four**:  Missile Type, Facility Name, Facility Location, Distance Travelled, Apogee 
  * **Prediction Model Five**: Missile Type, Facility Name, Facility Location, Distance Travelled, Apogee, Confirmation Status
  * **Prediction Model Six**:  Missile Types
  
  **Best predictive model**
  
  * Prediction model four and five have the highest accuracy score of **82.11%**, auc score of **0.8189**,and an error rate of **17.89%**.
  

```{r}
set.seed(123)
prediction_model_one <- sum( data.frame(train(clf_training[c('Missile.Type','Apogee')], clf_training[,18], method='rpart')$results)[c('Accuracy')] ) /3 
model_one_auc <-  calculate_auc(clf_training[c('Missile.Type','Apogee')], clf_training[,18])

prediction_model_two <- sum( data.frame(train(clf_training[c('Missile.Type', 'Facility.Name','Apogee')], clf_training[,18], method='rpart')$results)[c('Accuracy')] ) /3 
model_two_auc <-  calculate_auc(clf_training[c('Missile.Type', 'Facility.Name','Apogee')], clf_training[,18])

prediction_model_three <- sum( data.frame(train(clf_training[c('Missile.Type', 'Facility.Name','Facility.Location','Apogee')], clf_training[,18], method='rpart')$results)[c('Accuracy')] ) /3
model_three_auc <-  calculate_auc(clf_training[c('Missile.Type', 'Facility.Name','Facility.Location','Apogee')], clf_training[,18])

prediction_model_four <- sum( data.frame(train(clf_training[c('Missile.Type', 'Facility.Name','Facility.Location', 'Distance Travelled', 'Apogee')], clf_training[,18], method='rpart')$results)[c('Accuracy')] ) /3
model_four_auc <-  calculate_auc(clf_training[c('Missile.Type', 'Facility.Name','Facility.Location', 'Distance Travelled', 'Apogee')], clf_training[,18])

prediction_model_five <- sum( data.frame(train(clf_training[c('Missile.Type', 'Facility.Name','Facility.Location', 'Distance Travelled', 'Apogee', 'Confirmation.Status')], clf_training[,18], method='rpart')$results)[c('Accuracy')] ) /3
model_five_auc <-  calculate_auc(clf_training[c('Missile.Type', 'Facility.Name','Facility.Location', 'Distance Travelled', 'Apogee', 'Confirmation.Status')], clf_training[,18])

prediction_model_six <- sum( data.frame(train(clf_training[c('Missile.Type')], clf_training[,18], method='rpart')$results)[c('Accuracy')] ) /3
model_six_auc <-  calculate_auc(clf_training[c('Missile.Type')], clf_training[,18])

classification_summary <- c(prediction_model_one, prediction_model_two, prediction_model_three, prediction_model_four, prediction_model_five, prediction_model_six)
classification_summary <- data.frame(ACCURACY=classification_summary)
rownames(classification_summary) <- c("Pridiction Model 1", "Pridiction Model 2", "Pridiction Model 3", "Pridiction Model 4", "Pridiction Model 5", "Pridiction Model 6")

# Calculate AUC 
clf_models_auc <- c(model_one_auc, model_two_auc, model_three_auc, model_four_auc, model_five_auc, model_six_auc)
classification_summary['AUC'] <-clf_models_auc

# Error rate 
classification_error_rates <- 1 - classification_summary
classification_summary['ERROR RATE'] <- classification_error_rates

classification_summary['FEATURE COLUMNS'] <- c("Pridiction Model 1", "Pridiction Model 2", "Pridiction Model 3", "Pridiction Model 4", "Pridiction Model 5", "Pridiction Model 6")


# Prediction model accuracy comparison 
classification_summary %>% ggplot(aes(x=`FEATURE COLUMNS`, y=ACCURACY, fill=`FEATURE COLUMNS`)) + 
                            geom_bar(stat = "identity") + coord_flip()  + 
                            scale_y_continuous(limits = c(0:1) , breaks = seq(1:10) * 0.1 ) +
                            labs(title="Figure 4.1.1: Classification models Accuracy", x="Accuracy Scores")

# Prediction model AUC comparision
classification_summary %>% ggplot(aes(x=`FEATURE COLUMNS`, y=`AUC`, fill=`FEATURE COLUMNS`)) + 
                            geom_bar(stat = "identity") + coord_flip() +  
                            scale_y_continuous(limits = c(0:1) , breaks = seq(1:10) * 0.1 ) +
                            labs(title="Figure 4.1.2: Classification models AUC", x="AUC Scores") 

# Classification Error Rates 
classification_summary %>% ggplot(aes(x=`FEATURE COLUMNS`, y=`ERROR RATE`, fill=`FEATURE COLUMNS`)) + 
                            geom_bar(stat = "identity") + coord_flip() +  
                            scale_y_continuous(limits = c(0:1) , breaks = seq(1:10) * 0.1 ) +
                            labs(title="Figure 4.1.3: Classification models Error Rates", x="Error Rates") 

# Predictive Models Bench Mark 
pandoc.table(classification_summary, style='grid', "Table 4.2: Predictive Models Bench Mark " )
```

### Attempt to imporove **Prediction Model Five: Missile Type, Facility Name, Facility Location, Distance Travelled, Apogee, Confirmation Status**  Accuracy: Standardized the feature matrix  
  
  * Standardize the feature matrix (Missile Type, Facility Name, Facility Location, Distance Travelled, Apogee, Confirmation Status) reduces the accuracy 
  
```{r}
standardized_clf <- classification_model_missiles[c('Missile.Type', 'Facility.Name','Facility.Location', 'Distance Travelled', 'Apogee', 'Confirmation.Status')]
standardized_clf <- cbind((standardized_clf - sapply( standardized_clf, mean   ) )/ sapply( standardized_clf, sd   ), classification_model_missiles$Test.Outcome )
colnames(standardized_clf) <- c('Missile.Type', 'Facility.Name','Facility.Location', 'Distance Travelled', 'Apogee', 'Confirmation.Status', "Test.Outcome")
sd_clf_samples <- createDataPartition(standardized_clf$Test.Outcome, p=0.8, list=FALSE)

sd_training <- standardized_clf[sd_clf_samples,]
sd_testing <- standardized_clf[-sd_clf_samples,]
sd_results <- train(sd_training[,1:6], sd_training[,7], method='rpart')
sd_accuracy <- sum( data.frame(sd_results$results)[c('Accuracy')] ) /3 
sd_auc <- as.numeric(roc(sd_training$Test.Outcome, ifelse(predict(sd_results) == "Success", 1, 0 ))$auc)
sd_summary <- data.frame(ACCURACY=sd_accuracy, ERROR_RATE=1-sd_accuracy, AUC=sd_auc)
rownames(sd_summary) <- c("Standardized")
pandoc.table(  sd_summary, style='grid', "Table 4.2: Standardized Apogee and Missile Types Model")
```

# Attempt to imporove **Prediction Model Five**: Using KNN to classify the North Korea's Missile Tests

```{r}
get_best_knn_parameters <- function(df, n_neighbor) {
  return(train(df[,1:6], df[,7], method='knn', tuneGrid = expand.grid(k=n_neighbor) )$results[c('Accuracy')])
}
knn_models <- classification_model_missiles[c('Missile.Type', 'Facility.Name','Facility.Location', 'Distance Travelled', 'Apogee', 'Confirmation.Status', 'Test.Outcome')]
samples <- createDataPartition(knn_models$Test.Outcome, p=0.8, list=FALSE)
knn_training <- knn_models[samples,]
knn_testing <- knn_models[-samples,]

knn_accuracy_scores <- c()
knn_auc_scores <- c()
knn_index <- c()

for(n_neighbor in c(5:25)) {
  train_results <- train(knn_training[,1:6], knn_training[,7], method = 'knn', tuneGrid = expand.grid(k=n_neighbor))
  knn_accuracy_scores <- c( as.numeric( train_results$results[c('Accuracy')] ) , knn_accuracy_scores )
  knn_auc_scores <- c( as.numeric(roc(knn_training$Test.Outcome, ifelse(predict(train_results) == "Success", 1,0) )$auc), knn_auc_scores)
  knn_index <- c(n_neighbor, knn_index)
}
knn_summary <- data.frame(ACCURACY=knn_accuracy_scores, AUC=knn_auc_scores, ERROR_RATE=1 - knn_accuracy_scores)
rownames(knn_summary) <- knn_index

pandoc.table(knn_summary, style = "grid",  "Table 4.3: Attempt to improve North Korea's Missile Test classifications, using KNN ")

# KNN Accuracy using n_neighbors from 5 to 25 observations 
```

### Attempt to improve classification accuracy, auc and lower error rate, where n_neighbors = (5 - 25) observations

  * KNN performs better, when the K observation is equal to 8 or 9 (As you can see in **Figure 5.3**). Also, the KNN algorithm has the highest accuracy and the lowest error rates (As you can see in **Figure 5.1 and 5.2** ), when K-observation equals to 5 but I would still choose K-observation equals to 8 or 9 because the AUC scores evaluates the Algorithm performance. An AUC score close to 1, indicates a perfect model. On the other hand, an AUC score close to 0.5 or within this range indicates that the model simply peforms random guessing. 

```{r}
 knn_summary %>% ggplot(aes(x=knn_index, y=ACCURACY)) + 
                 geom_point(size=3, color='lightgreen') + 
                 geom_line(color='red',size=1) + 
                 facet_grid() + 
                 labs(title="Figure 5.1: KNN Accuracy in classifying North Korea's missile test outcome", x='K Number of Observations', y='Accuracy Scores') + 
                 scale_x_continuous(breaks = seq(from=5,to=30) )

 knn_summary %>% ggplot(aes(x=knn_index, y=ERROR_RATE)) + 
                 geom_point(size=3, color='lightgreen') + 
                 geom_line(color='red',size=1) + 
                 facet_grid() + 
                 labs(title="Figure 5.2: KNN Error Rate in classifying North Korea's missile test outcome", x='K Number of Observations', y='Error Rate') + 
                 scale_x_continuous(breaks = seq(from=5,to=30) )
 
  knn_summary %>% ggplot(aes(x=knn_index, y=AUC)) + 
                 geom_point(size=3, color='lightgreen') + 
                 geom_line(color='red',size=1) + 
                 facet_grid() + 
                 labs(title="Figure 5.3: KNN Performance in classifying North Korea's missile test outcome", x='K Number of Observations', y='AUC Scores') +
                 scale_x_continuous(breaks = seq(5:30) )
```

# Regression Analysis 

  **Partial Correlation**
  
  * The partial correlation between **Apogee and Distance Travelled, while controlling Facility Name** is **0.2958**, which is slightly less than the correlation when the effect of **Facility Name** is not controlled for (r=0.2965). This correlation is still statistically significant p < 0.01, the realtionship is diminished. In terms of variance, the value of ${{R}^2}$ for the partial corelation is 0.0875, which means that **Distance Travelled** can now account for only 8.75% of the variance in Missile Apogee. When the effect of the **Facility Name** were not controlled for, **Distance Travelled** shared about **8.79%** of the variation in Missile apogee and so the inclusion of **Facility Name** has slightly diminished the amount of variation in Missle apogee shared by Distance Travelled. In conclusion, running this analysis has shown that Distance Travelled alone does explain some of the variation in Missile Apogee, but there is a complex relationship between Missile Apogee, Distance Travelled, and Facility Name that might be otherwise have been ignored. 

  * The partial correlation between **Apogee and Distance Travelled, while controlling Missile Type** is **0.0225**, which is considerably less than the correlation when the effect of **Missile Type** is not controlled for (r=0.2965). This correlation is not statistically significant because p > 0.05, the realtionship is not diminished. In terms of variance, the value of ${{R}^2}$ for the partial corelation is 0.0225, which means that **Distance Travelled** can now account for only 2.25% of the variance in Missile Apogee. When the effect of the **Missile Type** were not controlled for, **Distance Travelled** shared about **8.79%** of the variation in Missile apogee and so the inclusion of **Missile Type** has severely diminished the amount of variation in Missile apogee shared by Distance Travelled. In conclusion, running this analysis has shown that Distance Travelled alone does explain some of the variation in Missile Apogee, but there is a complex relationship between Missile Apogee, Distance Travelled, and Missile Type that might be otherwise have been ignored. 
      
  * **Regression model to predict missile apogee**: 
      * **Prediction Model One**:  Missile Types and Test.Outcome can account for  **18.56%** of the variation in Missile Apogee
      * **Prediction Model Two**:  Missile Types, Confirmation Status, and Test.Outcome can account for **11.45%** of the variation in Missile Apogee
      * **Prediction Model Three**: Missile Type, Facility Name, Facility Location, Distance Travelled can account for **13.74%** of the variation in Missile Apogee
      * **Prediction Model Four**:  Missile Type, Facility Name, Facility Location, Distance Travelled, Test.Outcome can account for **11.07%** of the variation in Missile Apogee
      * **Prediction Model Five**: Missile Type, Facility Name, Facility Location, Distance Travelled, Confirmation Status can account for **17.95%** of the variation in Missile Apogee
      * **Prediction Model Six**:  Missile Types can account for **24.92%** of the variation in Missile Apogee
    
```{r}

features <- c("Missile.Type,Test.Outcome",
              "Missile.Type,Confirmation.Status,Test.Outcome", 
              "Missile.Type,Facility.Name,Facility.Location,Distance Travelled",
              "Missile.Type,Facility.Name,Facility.Location,Distance Travelled,Test.Outcome",
              "Missile.Type,Facility.Name,Facility.Location,Distance Travelled,Confirmation.Status", 
              "Missile.Type")

# Response variable: Missile Apogee 
set.seed(1000)
linreg_model <- classification_model_missiles[feature_columns]
linreg_model$Test.Outcome <- ifelse(linreg_model$Test.Outcome == "Success" ,1,0)
linreg_samples <- createDataPartition(linreg_model$Apogee, p=0.8, list=FALSE )
linreg_training <- linreg_model[linreg_samples,]
linreg_testing <- linreg_model[-linreg_samples,]

# Mining: Find the best models with the highest R-Squared and the lowest RMSE 
linreg_rmse <- c() 
linreg_rsquared <- c()
linreg_index <- features 

for (feature_col in features) {
  future_matrix <- linreg_training[as.vector(str_split(feature_col,",")[[1]])]
  linreg_results <- train(future_matrix, linreg_training[,1], method = "rpart")
  linreg_rmse <- c(sum(linreg_results$results[c('RMSE')]) / 3, linreg_rmse)
  linreg_rsquared <- c(sum(linreg_results$results[c('Rsquared')]) / 3, linreg_rsquared) 
}

mining_results <- data.frame(INDEX=linreg_index,RMSE=linreg_rmse, RSQUARED=linreg_rsquared)
mining_results <- mining_results %>% mutate(Summary=paste(INDEX, 'can account for', round(RSQUARED * 100, 4) , "% of the variation in Missile Apogee"))

# Partial correlation Missiles Apogge and Distance Travelled, while controling Facility Name 
pandoc.table( pcor.test(linreg_model$Apogee,linreg_model$`Distance Travelled` , linreg_model$Facility.Name), style="grid", "Table 4.4.1 :Partial correlation Missiles Apogge and Distance Travelled, while controling Facility Name")

# Partial correlation Apogee and Distance Travelled, while controling Missilie type 
pandoc.table( pcor.test(linreg_model$Apogee,linreg_model$`Distance Travelled`, linreg_model$Missile.Type), style="grid", "Table 4.4.2 :Partial correlation Apogee and Distance Travelled, while controling Missilie type ")

pandoc.table(mining_results, style="grid", "Table 4.4.3: Mining for models with the lowest RMSE and highest RSQUARED")

```

### Mining Results: The best linear models to predict Missile Apogee 
```{r fig.width=20, fig.height=12}

mining_results %>% mutate(FEATURES=fct_reorder(INDEX, RSQUARED)) %>% ggplot(aes(x=FEATURES, y=RMSE,fill=FEATURES)) +
                                                                     geom_bar(stat = "identity", width = 0.4) + 
                                                                     coord_flip() +
                                                                     labs(title="Figure 6:1.1 Feature Columns RMSE") +
                                                                     scale_y_continuous(breaks = seq(from=0, to=500, by=100) )

mining_results %>% mutate(FEATURES=fct_reorder(INDEX, RSQUARED)) %>% ggplot(aes(x=FEATURES, y=RSQUARED,fill=FEATURES)) +
                                                                     geom_bar(stat = "identity", width = 0.4) + 
                                                                     coord_flip() +
                                                                     labs(title="Figure 6:1.2 Feature Columns RSQUARED") +
                                                                     scale_y_continuous(breaks = seq(from=0, to=4, by=1) * 0.1 )
```


### Linear Regression Prediction: 

  * **Based on the mining results**: Missile.Type,Facility.Name, Facility.Location, Distance Travelled, Confirmation.Status can account for 21.33% of the variation in Missile Apogee. which means that 78.67% of the variation in Missile Apogee cannot be explained by this model alone. Therefore, there must be other variables that have an influence on Missile Apogee. The p-value < 0.01, so F=16 is significant at p < 0.01, Thus this result shows that there is less than a 0.1% chance that an F-ratio this small would happen if the null hypothesis were true and the regression model overall predicts the Missile Apogee significantly well. 
  
  * ${\boldsymbol{MissileApogee_i} = b_0 + b_1 \boldsymbol{Missile.Type} + b_2 \boldsymbol{Test.Outcome}}$  = 696.29 + (-144.96 Missile.Type_i) + (304.62 Test.Outcome) 
  
  * **Missile.Type**: Holding all other features fixed, (b = -144.96) indicates that as Missile.Type decreases by one unit (e.g. If we change the Missile Type category from ICBM = 1 to IRBM = 2 ), Missile apogee decreases by -144.96 (Km). Therefore every unit change/decrease in Missile.Type is associated with a decrease in missile apogee by -144.96 Km. 
  
  * **Test.Outcome**: Holding all other features fixed, (b=304.62) indicates that as the number of Test.Outcome increases by one unit (e.g. Test.Outcome from 0 = Failure to 1 = Success), Missile apogee increases by one unit. Therefore, every unit increase in the Test.Outcome is associated with with an range extra of 304.62 Km in Missile Apogee. 
    
```{r}
  summary(lm("Apogee ~ Missile.Type + Test.Outcome", data=linreg_training ))
```

### History of North Korea Missile testing and developments
```{r}

nk_missiles$YEAR <- as.numeric(nk_missiles$YEAR)

# Missile tests under Kim Il-Sung
pandoc.table( data.frame(data.frame(nk_missiles %>% filter(YEAR < 1994) )[c('Missile.Type', 'Missile.Name', 'Facility.Location', 'Facility.Name')] %>% count(Missile.Type, Missile.Name, Facility.Location, Facility.Name) %>% mutate(Description=paste("Under Kim Il-Sung North Korea has conducted",n, Missile.Name, Missile.Type, "tests at", Facility.Name, "located in", Facility.Location ))) , style="grid", "Figure A.2.1: North Korea Missile Development Under Kim Il-Sung " )

# Missile tests under Kim Jong-Il
pandoc.table( data.frame(data.frame(nk_missiles %>% filter(YEAR >= 1994 & YEAR <= 2011 ) )[c('Missile.Type', 'Missile.Name', 'Facility.Location', 'Facility.Name')] %>% count(Missile.Type, Missile.Name, Facility.Location, Facility.Name) %>% mutate(Description=paste("Under Kim Jong-Il North Korea has conducted",n, Missile.Name, Missile.Type, "tests at", Facility.Name, "located in", Facility.Location ))) , style="grid", "Figure A.2.2: North Korea Missile Development Under Kim Jong-Il " )

# Missile tests under Kim Jong-Un
pandoc.table( data.frame(data.frame(nk_missiles %>% filter(YEAR >= 2011 ) )[c('Missile.Type', 'Missile.Name', 'Facility.Location', 'Facility.Name', 'Date' ,'Launch.Time..UTC.')] %>% count(Missile.Type, Missile.Name, Facility.Location, Facility.Name, Date, `Launch.Time..UTC.`) %>% mutate(Description=paste("Under Kim Jong-Un North Korea has conducted",n, Missile.Name, Missile.Type, "tests at", Facility.Name, "located in", Facility.Location, 'on', Date, 'at', `Launch.Time..UTC.` ))) , style="grid", "Figure A.2.3: North Korea Missile Development Under Kim Jong-Un " )
```

## Summary of Overall Analysis 
  
  **Brief History of North Korea's Missile Developments**
  
  - North Korea continues to advance its missile and nuclear programs despite high-level diplomatic and UN Security Council sanctions (Number of testing conducted at North Korea missile testing facalities **Figure 1.2.2**). According to  **NTI [2]**, ever since 2014 North Korea has dramatically altered its missile testing, in fact North Korea has 19 successful missile testing (As you can see in **Table 1.1.5**). **Under Kim Jong Un**, they were conducting the following missile tests in 2014:
  
    1. Under Kim Jong Un, North Korea has conducted 2 successful Nodong MRBM tests at Sunchon Airbase  located in  South Pyongan Province  in 2014.
    2. Under Kim Jong Un, North Korea has conducted 4 successful KN-02 SRBM tests at Hodo Peninsula  located in  Kangwon Province, (North Korea)  in 2014.
    3. Under Kim Jong Un, North Korea has conducted 4 successful Scud-B SRBM tests at Kittaeryong Missile Base  located in  Kittae Pass, Kangwon Province, (North Korea)  in 2014.
    4. Under Kim Jong Un, North Korea has conducted 2 successful Scud-C SRBM tests at Hwangju  located in  Hwangju,  North Hwanghae province  in 2014.
    5. Under Kim Jong Un, North Korea has conducted 2 successful Scud-C SRBM tests at Masikryong  located in  Kangwon Province, (North Korea)  in 2014.
    6. Under Kim Jong Un, North Korea has conducted 2 successful Scud-C SRBM tests at Wonsan Kalma International Airport  located in  Kangwon Province, (North Korea)  in 2014.
    7. Under Kim Jong Un, North Korea has conducted 2 successful Scud-C SRBM tests at Kaesong  located in  North Hwanghae Province  in 2014.
    8. Under Kim Jong Un, North Korea has conducted 1 successful Scud-C SRBM tests at Unknown  located in  Unknown in 2014.
  
  **North Korea's missile development under Kim Sung IL (1984 to 1994)**
    
  - Under Kim Sung Il, North Korea has carried out 15 missile tests (**Table A.2.1**), which includes:
  
  1. Under Kim Il-Sung North Korea has conducted 3  Nodong MRBM tests at Tonghae Satellite Launching Ground located in Hwadae County, North Hamgyong Province
  2. Under Kim Il-Sung North Korea has conducted 6  Scud-B SRBM tests at Tonghae Satellite Launching Ground located in Hwadae County, North Hamgyong Province
  3. Under Kim Il-Sung North Korea has conducted 1  Scud-C SRBM tests at Chihari Missile Base located in Chiha-ri , Kangwon Province, (North Korea)
  4. Under Kim Il-Sung North Korea has conducted 4  Scud-C SRBM tests at Tonghae Satellite Launching Ground located in Hwadae County, North Hamgyong Province
  5. Under Kim Il-Sung North Korea has conducted 1  Unknown Unknown tests at Tonghae Satellite Launching Ground located in Hwadae County, North Hamgyong Province
    
  **North Korea's missile development under Kim Jong IL (1994 to 2011)**
    
  - North Korea missile testing and development paused for four years, after Kim Sung Il passed in July, 8 1994. Kim Jong Il restarted missile testing with an attempt to launch Taepodong ICBM in 1998. The missile testing made it off the ground and landed and exploded over the pacific close to Japan **[2]**. Under Kim Jong-Il, North Koread has carried out 10 missile tests (**Table A.2.2**), which includes: 
  
  1. Under Kim Jong-Il North Korea has conducted 6  Nodong MRBM tests at Kittaeryong Missile Base located in Kittae Pass, Kangwon Province, (North Korea)
  2. Under Kim Jong-Il North Korea has conducted 1  Taepodong-1 SLV tests at Tonghae Satellite Launching Ground located in Hwadae County, North Hamgyong Province
  3. Under Kim Jong-Il North Korea has conducted 2  Unha SLV tests at Tonghae Satellite Launching Ground located in Hwadae County, North Hamgyong Province
  4. Under Kim Jong-Il North Korea has conducted 7  Scud-C SRBM tests at Kittaeryong Missile Base located in Kittae Pass, Kangwon Province, (North Korea)
  
  **North Korea's missile development under Kim Jong Un Tests (2011 to May 2019)**
    
  - Under Kim Jung-Un, North Korea has carried out a total 118 missile tests (**Table A.2.3**), which includes: 
  
  1. Under Kim Jong-Un North Korea has conducted 1  Hwasong-14 ICBM tests at Panghyon located in Kusong, North Pyongan on 2017-07-04 at 00:40:00
  2. Under Kim Jong-Un North Korea has conducted 1  Hwasong-14 ICBM tests at Mupyong-ni Arms Plant located in Mup'yong-ni, Chagang province on 2017-07-28 at 14:42:00
  3. Under Kim Jong-Un North Korea has conducted 1  Hwasong-15 ICBM tests at Pyongsong Field located in Pyongsong, South Pyongan Province on 2017-11-28 at 18:18:00
  4. Under Kim Jong-Un North Korea has conducted 1  Hwasong-12 IRBM tests at North Kusong Testing Ground located in Kusong, North Pyongan on 2017-05-14 at 20:28:00
  5. Under Kim Jong-Un North Korea has conducted 1  Hwasong-12 IRBM tests at Pyongyang International Airport located in Pyongyang, North Korea on 2017-08-28 at 20:58:00
  6. Under Kim Jong-Un North Korea has conducted 1  Hwasong-12 IRBM tests at Pyongyang International Airport located in Pyongyang, North Korea on 2017-09-14 at 21:57:00
  7. Under Kim Jong-Un North Korea has conducted 1  Hwasong-12 IRBM tests at Sinpo Shipyard located in South Hamgyong province on 2017-04-04 at 21:42:00
  8. Under Kim Jong-Un North Korea has conducted 1  Hwasong-12 IRBM tests at Sinpo Shipyard located in South Hamgyong province on 2017-04-15 at 21:21:00
  9. Under Kim Jong-Un North Korea has conducted 1  Hwasong-12 IRBM tests at Pukchang Airfield located in South Pyongan Province on 2017-04-28 at 20:33:00
  10. Under Kim Jong-Un North Korea has conducted 1  Musudan IRBM tests at Wonsan Kalma International Airport located in Kangwon Province, (North Korea) on 2016-04-15 at 20:33:00
  11. Under Kim Jong-Un North Korea has conducted 1  Musudan IRBM tests at Wonsan Kalma International Airport located in Kangwon Province, (North Korea) on 2016-04-27 at 21:33:00
  12. Under Kim Jong-Un North Korea has conducted 1  Musudan IRBM tests at Wonsan Kalma International Airport located in Kangwon Province, (North Korea) on 2016-04-28 at 10:24:00
  13. Under Kim Jong-Un North Korea has conducted 1  Musudan IRBM tests at Wonsan Kalma International Airport located in Kangwon Province, (North Korea) on 2016-05-30 at 20:30:00
  14. Under Kim Jong-Un North Korea has conducted 1  Musudan IRBM tests at Wonsan Kalma International Airport located in Kangwon Province, (North Korea) on 2016-06-21 at 20:56:00
  15. Under Kim Jong-Un North Korea has conducted 1  Musudan IRBM tests at Wonsan Kalma International Airport located in Kangwon Province, (North Korea) on 2016-06-21 at 23:03:00
  16. Under Kim Jong-Un North Korea has conducted 1  Musudan IRBM tests at Panghyon Airbase located in Kusong, North Pyongan on 2016-10-14 at 18:33:00
  17. Under Kim Jong-Un North Korea has conducted 1  Musudan IRBM tests at Panghyon Airbase located in Kusong, North Pyongan on 2016-10-19 at 22:00:00
  18. Under Kim Jong-Un North Korea has conducted 5  ER Scud MRBM tests at Sohae Satellite Launching Station located in Cholsan County, North Pyongan Province on 2017-03-05 at 22:34:00
  19. Under Kim Jong-Un North Korea has conducted 3  ER Scud MRBM tests at Hwangju located in Hwangju,  North Hwanghae province on 2016-09-05 at 03:13:00
  20. Under Kim Jong-Un North Korea has conducted 1  Nodong MRBM tests at Hwangju located in Hwangju,  North Hwanghae province on 2016-07-18 at 21:35:00
  21. Under Kim Jong-Un North Korea has conducted 2  Nodong MRBM tests at Hwangju located in Hwangju,  North Hwanghae province on 2016-08-02 at 22:53:00
  22. Under Kim Jong-Un North Korea has conducted 2  Nodong MRBM tests at Sunchon Airbase located in South Pyongan Province on 2014-03-26 at 
  23. Under Kim Jong-Un North Korea has conducted 2  Nodong MRBM tests at Sunchon Airbase located in South Pyongan Province on 2016-03-18 at 
  24. Under Kim Jong-Un North Korea has conducted 1  Pukguksong-2 MRBM tests at Kusong Testing Ground located in Kusong, North Pyongan on 2017-02-11 at 22:55:00
  25. Under Kim Jong-Un North Korea has conducted 1  Pukguksong-2 MRBM tests at Lake Yonpung located in South Pyongan Province on 2017-05-21 at 07:59:00
  26. Under Kim Jong-Un North Korea has conducted 1  Pukguksong-1 SLBM tests at Sinpo Shipyard located in South Hamgyong province on 2015-05-08 at 
  27. Under Kim Jong-Un North Korea has conducted 1  Pukguksong-1 SLBM tests at Sinpo Shipyard located in South Hamgyong province on 2015-11-28 at 
  28. Under Kim Jong-Un North Korea has conducted 1  Pukguksong-1 SLBM tests at Sinpo Shipyard located in South Hamgyong province on 2015-12-21 at 
  29. Under Kim Jong-Un North Korea has conducted 1  Pukguksong-1 SLBM tests at Sinpo Shipyard located in South Hamgyong province on 2016-04-23 at 09:29:00
  30. Under Kim Jong-Un North Korea has conducted 1  Pukguksong-1 SLBM tests at Sinpo Shipyard located in South Hamgyong province on 2016-07-09 at 02:28:00
  31. Under Kim Jong-Un North Korea has conducted 1  Pukguksong-1 SLBM tests at Sinpo Shipyard located in South Hamgyong province on 2016-08-23 at 20:29:00
  32. Under Kim Jong-Un North Korea has conducted 1  Pukguksong-3 SLBM tests at Yonghung Bay located in Kangwon Province, (North Korea) on 2019-10-01 at 22:00:00
  33. Under Kim Jong-Un North Korea has conducted 1  Unha-3 SLV tests at Sohae Satellite Launching Station located in Cholsan County, North Pyongan Province on 2012-04-13 at 
  34. Under Kim Jong-Un North Korea has conducted 1  Unha-3 SLV tests at Sohae Satellite Launching Station located in Cholsan County, North Pyongan Province on 2012-12-12 at 
  35. Under Kim Jong-Un North Korea has conducted 1  Unha-3 SLV tests at Sohae Satellite Launching Station located in Cholsan County, North Pyongan Province on 2016-02-07 at 00:29:00
  36. Under Kim Jong-Un North Korea has conducted 3  KN-02 SRBM tests at Hodo Peninsula located in Kangwon Province, (North Korea) on 2013-05-18 at 
  37. Under Kim Jong-Un North Korea has conducted 1  KN-02 SRBM tests at Hodo Peninsula located in Kangwon Province, (North Korea) on 2013-05-19 at 
  38. Under Kim Jong-Un North Korea has conducted 2  KN-02 SRBM tests at Hodo Peninsula located in Kangwon Province, (North Korea) on 2013-05-20 at 
  39. Under Kim Jong-Un North Korea has conducted 1  KN-02 SRBM tests at Hodo Peninsula located in Kangwon Province, (North Korea) on 2014-06-26 at 
  40. Under Kim Jong-Un North Korea has conducted 1  KN-02 SRBM tests at Hodo Peninsula located in Kangwon Province, (North Korea) on 2014-08-14 at 
  41. Under Kim Jong-Un North Korea has conducted 1  KN-02 SRBM tests at Hodo Peninsula located in Kangwon Province, (North Korea) on 2014-09-01 at 
  42. Under Kim Jong-Un North Korea has conducted 1  KN-02 SRBM tests at Hodo Peninsula located in Kangwon Province, (North Korea) on 2014-09-06 at 
  43. Under Kim Jong-Un North Korea has conducted 5  KN-02 SRBM tests at Hodo Peninsula located in Kangwon Province, (North Korea) on 2015-02-08 at 
  44. Under Kim Jong-Un North Korea has conducted 1  KN-02 SRBM tests at Hodo Peninsula located in Kangwon Province, (North Korea) on 2015-04-02 at 
  45. Under Kim Jong-Un North Korea has conducted 4  KN-02 SRBM tests at Hodo Peninsula located in Kangwon Province, (North Korea) on 2015-04-03 at 
  46. Under Kim Jong-Un North Korea has conducted 1  KN-23 SRBM tests at Hodo Peninsula located in Kangwon Province, (North Korea) on 2019-05-04 at 
  47. Under Kim Jong-Un North Korea has conducted 1  KN-23 SRBM tests at Hodo Peninsula located in Kangwon Province, (North Korea) on 2019-05-04 at 01:54:00
  48. Under Kim Jong-Un North Korea has conducted 1  KN-23 SRBM tests at Hodo Peninsula located in Kangwon Province, (North Korea) on 2019-07-24 at 20:34:00
  49. Under Kim Jong-Un North Korea has conducted 1  KN-23 SRBM tests at Hodo Peninsula located in Kangwon Province, (North Korea) on 2019-07-24 at 20:57:00
  50. Under Kim Jong-Un North Korea has conducted 2  KN-23 SRBM tests at Kwail Airbase located in Kwail, Kwail-gun, South Hwanghae on 2019-08-06 at 
  51. Under Kim Jong-Un North Korea has conducted 1  KN-23 SRBM tests at Baegun located in North Pyongan, North Korea on 2019-05-09 at 07:29:00
  52. Under Kim Jong-Un North Korea has conducted 1  KN-23 SRBM tests at Baegun located in North Pyongan, North Korea on 2019-05-09 at 07:49:00
  53. Under Kim Jong-Un North Korea has conducted 1  KN-24 SRBM tests at Hungnam located in Hamhung, South Hamgyong on 2019-08-09 at 20:34:00
  54. Under Kim Jong-Un North Korea has conducted 1  KN-24 SRBM tests at Hungnam located in Hamhung, South Hamgyong on 2019-08-09 at 20:50:00
  55. Under Kim Jong-Un North Korea has conducted 1  KN-24 SRBM tests at Tongchan located in Kangwon Province, (North Korea) on 2019-08-15 at 23:01:00
  56. Under Kim Jong-Un North Korea has conducted 1  KN-24 SRBM tests at Tongchan located in Kangwon Province, (North Korea) on 2019-08-15 at 23:16:00
  57. Under Kim Jong-Un North Korea has conducted 1  KN-24 SRBM tests at Sunchon located in North Pyongan Province on 2020-03-20 at 21:45:00
  58. Under Kim Jong-Un North Korea has conducted 1  KN-24 SRBM tests at Sunchon located in North Pyongan Province on 2020-03-20 at 21:50:00
  59. Under Kim Jong-Un North Korea has conducted 1  KN-25 SRBM tests at Sangum-ri located in Anbyon County, Kangwon Province (North Korea) on 2020-03-02 at 03:37:00
  60. Under Kim Jong-Un North Korea has conducted 1  KN-25 SRBM tests at Sangum-ri located in Anbyon County, Kangwon Province (North Korea) on 2020-03-02 at 03:37:20
  61. Under Kim Jong-Un North Korea has conducted 1  KN-25 SRBM tests at Yonpo Airport located in Hamhung, South Hamgyong Province on 2019-11-28 at 07:59:00
  62. Under Kim Jong-Un North Korea has conducted 1  KN-25 SRBM tests at Yonpo Airport located in Hamhung, South Hamgyong Province on 2019-11-28 at 07:59:30
  63. Under Kim Jong-Un North Korea has conducted 1  KN-25 SRBM tests at Kaechon Air Base located in Kaechon, South Pyongan Province on 2019-09-09 at 
  64. Under Kim Jong-Un North Korea has conducted 1  KN-25 SRBM tests at Kaechon Air Base located in Kaechon, South Pyongan Province on 2019-09-09 at 21:53:00
  65. Under Kim Jong-Un North Korea has conducted 1  KN-25 SRBM tests at Kaechon Air Base located in Kaechon, South Pyongan Province on 2019-09-09 at 22:12:00
  66. Under Kim Jong-Un North Korea has conducted 1  KN-25 SRBM tests at Hodo Peninsula located in Kangwon Province, (North Korea) on 2020-03-28 at 21:10:00
  67. Under Kim Jong-Un North Korea has conducted 1  KN-25 SRBM tests at Hodo Peninsula located in Kangwon Province, (North Korea) on 2020-03-28 at 21:10:20
  68. Under Kim Jong-Un North Korea has conducted 1  KN-25 SRBM tests at Sondok located in Sondok, South Hamgyong Province on 2020-03-08 at 22:36:00
  69. Under Kim Jong-Un North Korea has conducted 1  KN-25 SRBM tests at Sondok located in Sondok, South Hamgyong Province on 2020-03-08 at 22:36:20
  70. Under Kim Jong-Un North Korea has conducted 1  KN-25 SRBM tests at Sondok located in Sondok, South Hamgyong Province on 2020-03-08 at 22:37:20
  71. Under Kim Jong-Un North Korea has conducted 1  KN-25 SRBM tests at Sondok Airbase located in Sondok, South Hamgyong Province on 2019-08-23 at 21:45:00
  72. Under Kim Jong-Un North Korea has conducted 1  KN-25 SRBM tests at Sondok Airbase located in Sondok, South Hamgyong Province on 2019-08-23 at 22:02:00
  73. Under Kim Jong-Un North Korea has conducted 1  KN-25 SRBM tests at Sunchon Airbase located in South Pyongan Province on 2019-10-31 at 07:35:00
  74. Under Kim Jong-Un North Korea has conducted 1  KN-25 SRBM tests at Sunchon Airbase located in South Pyongan Province on 2019-10-31 at 07:38:00
  75. Under Kim Jong-Un North Korea has conducted 4  Scud-B SRBM tests at Kittaeryong Missile Base located in Kittae Pass, Kangwon Province, (North Korea) on 2014-02-27 at 
  76. Under Kim Jong-Un North Korea has conducted 1  Scud-B MaRV SRBM tests at Kittaeryong Missile Base located in Kittae Pass, Kangwon Province, (North Korea) on 2017-08-25 at 21:49:00
  77. Under Kim Jong-Un North Korea has conducted 1  Scud-B MaRV SRBM tests at Kittaeryong Missile Base located in Kittae Pass, Kangwon Province, (North Korea) on 2017-08-25 at 22:07:00
  78. Under Kim Jong-Un North Korea has conducted 1  Scud-B MaRV SRBM tests at Kittaeryong Missile Base located in Kittae Pass, Kangwon Province, (North Korea) on 2017-08-25 at 22:19:00
  79. Under Kim Jong-Un North Korea has conducted 2  Scud-C SRBM tests at Hwangju located in Hwangju,  North Hwanghae province on 2014-07-09 at 
  80. Under Kim Jong-Un North Korea has conducted 2  Scud-C SRBM tests at Hwangju located in Hwangju,  North Hwanghae province on 2016-03-10 at 
  81. Under Kim Jong-Un North Korea has conducted 1  Scud-C SRBM tests at Hwangju located in Hwangju,  North Hwanghae province on 2016-07-18 at 20:44:00
  82. Under Kim Jong-Un North Korea has conducted 1  Scud-C SRBM tests at Hwangju located in Hwangju,  North Hwanghae province on 2016-07-18 at 20:58:00
  83. Under Kim Jong-Un North Korea has conducted 2  Scud-C SRBM tests at Masikryong located in Kangwon Province, (North Korea) on 2014-06-29 at 
  84. Under Kim Jong-Un North Korea has conducted 2  Scud-C SRBM tests at Wonsan Kalma International Airport located in Kangwon Province, (North Korea) on 2014-03-03 at 
  85. Under Kim Jong-Un North Korea has conducted 2  Scud-C SRBM tests at Kaesong located in North Hwanghae Province on 2014-07-13 at 
  86. Under Kim Jong-Un North Korea has conducted 2  Scud-C SRBM tests at Nampo located in South Pyongan Province on 2015-03-01 at 
  87. Under Kim Jong-Un North Korea has conducted 1  Scud-C SRBM tests at Unknown located in Unknown on 2014-07-26 at 
  88. Under Kim Jong-Un North Korea has conducted 1  Scud-C MaRV SRBM tests at Wonsan Kalma International Airport located in Kangwon Province, (North Korea) on 2017-05-28 at 20:40:00
  89. Under Kim Jong-Un North Korea has conducted 1  Unknown Unknown tests at Wonsan Kalma International Airport located in Kangwon Province, (North Korea) on 2017-03-21 at 22:00:00
      
  - Overall North Korea has conducted 118 successful missile tests, 28 failures missile tests, and 3 unkown missile tests outcome from 1984 to 2020 (As illustrated in **Figure 1.4.1**), also looking at the frequency of missile tests conducted by the North Korea under Kim Jong-Un. It seems that Kim Jung-Un is a pretty ambitious person with the goal to strengthen the credibility of North Korea's regional nuclear deterrent strategy and project its power in Asia.
  
  **Project Background**
  
  - The purpose of this Final Project is to analyze North Korea missile testing, developments, and capabilities. Also, to compare North Korea's vs Russians missiles technologies similarities. Since Russia is North Korea's allies and the biggest weapons manufacturers in the world, beside the United States. I found similiarty between North Korea **Hwasong-6 SRBM** and the Russian made **Scud-C SRBM [5]**, the missile has a launch weight of ${\pm \boldsymbol{6,400kg}}$, range of ${\pm \boldsymbol{500Km}}$, and it is capable of carrying approximately 700 to 770 Kg of **high explosive, chemical, biological, and submunitions**. North Korea has reportedly shipped its **Hwasong-6 SRBM** to countries like Yemen, Egypt, Syria, Libya, Iran, also Iran has fired one **Scud-C Qiam1** missile in its ballistic missile strike against **ISIS** targets in Syria on June 18,2017 **[3]**.  
  
  **Distribution of Missile Apogee**
  
  - Missile Apogee is positively skew and the normal Quantile-Quantile Plots shows that the data values deviating away from the diagonal. The distribution graph seems to suggest that missile apogee were much more clustered around the low end of the scale. Since this is an overall distribution of missile apogee, the skew might occur because some missile types can travel further distance than the others (e.g. ICBM can travels up to 4475 Km).
  
  **Distribution of Distance travelled**
  
  - Missile distance travelled is positively skew and the normal Quantile-Quantile Plots shows that the data values deviating away from the diagonal. The distribution graph seems to suggest that missile distance travelled were much more clustered around the low end of the scale. Since this is an overall distribution of missile distance travelled, the skew might occur because some missile types can travel further distance than the others (e.g. ICBM can be fired from distance close to 1000 Km). 
  
  **Partial Correlation: Relationship between missile Apogee and Distanced Travelled**
  
  * To study the relationship between Missile Apogee and Distance Travelled, I'm going to control the effects of **Facility.Name** and **Missile.Type** on **Missile Apogee and Distance Travelled** because I believe that each missile types have its own maximum range and capabilities. Also, each testing facilities has its own capability in developing different types of missiles.
  
  **Controlling the effect of Facility Name**:
  
  * The partial correlation between Apogee and Distance Travelled, while controlling Facility Name is **0.2958**, which is slightly less than the correlation when the effect of Facility Name is not controlled for (**r=0.2965**). This correlation is still statistically significant p < 0.01, the realtionship is diminished. In terms of variance, the value of ${{R}^2}$ for the partial corelation is **0.0875**, which means that Distance Travelled can now account for only **8.75%** of the variance in Missile Apogee. When the effect of the Facility Name were not controlled for, Distance Travelled shared about **8.79%** of the variation in Missile apogee and so the inclusion of Facility Name has slightly diminished the amount of variation in Missle apogee shared by Distance Travelled. In conclusion, running this analysis has shown that Distance Travelled alone does explain some of the variation in Missile Apogee, but there is a complex relationship between Missile Apogee, Distance Travelled, and Facility Name that might be otherwise have been ignored.
  
  **Controlling the effect of Missile Type**:
  
  * The partial correlation between Apogee and Distance Travelled, while controlling Missile Type is **0.0225**, which is considerably less than the correlation when the effect of Missile Type is not controlled for (**r=0.2965**). This correlation is not statistically significant because p > 0.05, the realtionship is not diminished. In terms of variance, the value of ${{R}^2}$ for the partial corelation is **0.0225**, which means that Distance Travelled can now account for only **2.25%** of the variance in Missile Apogee. When the effect of the Missile Type were not controlled for, Distance Travelled shared about 8.79% of the variation in Missile apogee and so the inclusion of Missile Type has severely diminished the amount of variation in Missile apogee shared by Distance Travelled. In conclusion, running this analysis has shown that Distance Travelled alone does explain some of the variation in Missile Apogee, but there is a complex relationship between Missile Apogee, Distance Travelled, and Missile Type that might be otherwise have been ignored.

### Predicting North Korea's Missile Apogee

  **Regression Analysis**:
  
  - **Mining results**: the best predictive models that have the lowest RMSE and the highest ${\boldsymbol{{R}^2}}$ are shown in **Table 4.4.3** and **Figure 6.1.1 and 6.1.2**. It turns out that **Missile.Type,Test.Outcome** is a good model in predicting Missile Apogee. 
  
  **Building predictive models that can help predict Missile Apogee**:
  
  - Prediction Model One: Missile Types and Test.Outcome can account for 18.56% of the variation in Missile Apogee
  - Prediction Model Two: Missile Types, Confirmation Status, and Test.Outcome can account for **11.45%** of the variation in Missile Apogee
  - Prediction Model Three: Missile Type, Facility Name, Facility Location, Distance Travelled can account for **13.74%** of the variation in Missile Apogee
  - Prediction Model Four: Missile Type, Facility Name, Facility Location, Distance Travelled, Test.Outcome can account for **11.07%** of the variation in Missile Apogee
  - Prediction Model Five: Missile Type, Facility Name, Facility Location, Distance Travelled, Confirmation Status can account for **17.95%** of the variation in Missile Apogee
  - Prediction Model Six: Missile Types can account for **24.92%** of the variation in Missile Apogee
  
  **Based on the mining results**: Missile.Type,Facility.Name, Facility.Location, Distance Travelled, Confirmation.Status can account for **21.33%** of the variation in Missile Apogee. which means that **78.67%** of the variation in Missile Apogee cannot be explained by this model alone. Therefore, there must be other variables that have an influence on Missile Apogee. The p-value < 0.01, so F=16 is significant at p < 0.01, Thus this result shows that there is less than a 0.1% chance that an F-ratio this small would happen if the null hypothesis were true and the regression model overall predicts the Missile Apogee significantly well.
  
  **Prediction model paramters**
  
  * ${\boldsymbol{MissileApogee_i} = b_0 + b_1 \boldsymbol{Missile.Type} + b_2 \boldsymbol{Test.Outcome}}$  = 696.29 + (-144.96 Missile.Type_i) + (304.62 Test.Outcome) 

  * Missile.Type: Holding all other features fixed, (b = -144.96) indicates that as Missile.Type decreases by one unit (e.g. If we change the Missile Type category from ICBM = 1 to IRBM = 2 ), Missile apogee decreases by -144.96 (Km). Therefore every unit change/decrease in Missile.Type is associated with a decrease in missile apogee by -144.96 Km.
  
  * Test.Outcome: Holding all other features fixed, (b=304.62) indicates that as the number of Test.Outcome increases by one unit (e.g. Test.Outcome from 0 = Failure to 1 = Success), Missile apogee increases by one unit. Therefore, every unit increase in the Test.Outcome is associated with with an range extra of 304.62 Km in Missile Apogee.
  
### Classifying North Korea's Missile Test Outcome
  
  **Looking at relationships between predictive variables:** 
    
  * **Apogee** shares **1.019%** of the variability in Test.Outcome
  * **Confirmation.Status** shares **0.6124%** of the variability in Test.Outcome
  * **Distance.Travelled**  shares **0.1004%**   of the variability in Test.Outcome 
  * **Facility.Name** shares **17.1%** of the variability in Test.Outcome
  * **Facility.Location** shares **0.02649%** of the variability in Test.Outcome
  * **Missile.Type** shares **11.1%** of the variability in Test.Outcome 
    
  **Building predictive models that can help predict the outcome from North Korea's Missile Tests:**
    
  * **Prediction Model One**:  Missile Types and Apogee has an ACCURACY of **79.98%** and ,AUC score of **0.7884** , and ERROR RATE of **20.02%**
  * **Prediction Model Two**:  Missile Types, Facility Name, and Apogee has an ACCURACY of **80.97%** and ,AUC score of **0.8189** , and ERROR RATE of **19.03%**
  * **Prediction Model Three**: Missile Type, Facility Name, Facility Location, Apogee has an ACCURACY of **80.06%** and ,AUC score of **0.8189** , and ERROR RATE of **19.94 %**
  * **Prediction Model Four**:  Missile Type, Facility Name, Facility Location, Distance Travelled, Apogee has an ACCURACY of **82.11%** and ,AUC score of **0.8189** , and ERROR RATE of **17.89%**
  * **Prediction Model Five**: Missile Type, Facility Name, Facility Location, Distance Travelled, Apogee, Confirmation Status  has an ACCURACY of **82.11%** and ,AUC score of **0.8189**, and ERROR RATE of **17.89%**
  * **Prediction Model Six**:  Missile Types has an ACCURACY of **80.7%** and ,AUC score of **0.7326** , and ERROR RATE of **19.3%**
  
## Problem Summary 
1. How many missile tests conducted by the North Korea?
    * From 1984 to 2020 North Korea has 118 successful missile tests , 28 failures missile tests , and 3 unkown missile tests outcome. 
  
2. What are the maximum ranges for these missiles?
  * Hwasong-14 ICBM has a maximum range of 3724 Km
  * Hwasong-15 ICBM has a maximum range of 4475 Km
  * Hwasong-12 IRBM has a maximum range of 2111 Km
  * Pukguksong-2 MRBM as a maximum range of 560 Km
  * Pukguksong-3 SLBM as a maximum range of 910 Km
  * KN-24 SRBM  has a maximum range of 50 Km
  * Scud-C MaRV SRBM has a maximum range of 120 Km
    
    
3. Where and when these tests has been conducted?
    * Please reffer to **Table 1.1.3** and **Figure 1.2.2**
  
  
4. What are the outcome from these missiles tests? 
    * The outcome of the North Korea's missile test illustrated in **Table 1.1.4** and **Figure 1.4.1**
  
  
5. How many succesful tests has been conducted by the North Korea?
    * North Korea has 118 succesful missile tests (As you can see in **Figure 1.4.1**)
  
  
6. How many failure tests has been conducted by the North Korea?
    * North Korea has 28 succesful missile tests (As you can see in **Figure 1.4.1**)
  
  
7. What types of missiles, did North Korea build/tested each years?
    * Summary of North Korea's Missile Tests from 1984 to 2020 provided in **Table A.1**
    
    
8. Based on the ranges and types, determine country of origins if possible? 
    * SCUD-C: The **Hwasong-6** is similar to the Russian **Scud C** Short Range Ballistic Missile. Also, this missile is similar to **The Shahab-2** the Iranian variant of the Russian **SS-1D Scud-C**. In 1991, Iran has purchased 60 missiles from North Korea. It is possible that up to 400 **Hwasong-6** missiles may have been exported to **Egypt, Iraq, Yemen, Libya, Syria, Vietnam, Iran** have a possesion. According to Iranian meida, Iran fired at least one Scud-C Qiam-1 missile in its ballistic missile strike against ISIS targets in Syria on June 18,2017. 
    
    * **Musudan Intermediate-Range Ballistic Missile** is based on the **Soviet R-27'Serb SLBM** missile which uses a 4D10 engine propelled by unsymmetrical dimethyl hydrazine (**UDMH**) and nitrogen tetroxide (**NTO**). Reports suggest that Iran purchased 18 Musudan missile sets from North Korea in 2005. In 2009, additional reports shows that Musudan parts were transerred to Iran. 

9. Why does North Korea have so many SRBM in their possession? 
    * According to **Federation of American Scientists [5]**, in the past year, North Korea increased short-range ballistic missiles (SRBM) test launches (As you can see in **Figure 1.1.1 and 1.4.3**). The advancement in SRBM and MRBM demonstrate the North Korean shift toward solid-propellants and satellite guidance systems; advances that could carry over to larger, more potent system like the Hwasong series ICBMs. These developments can provide the projectiles greater mobility and survivability prior to launch and greater potency and precision target. 
  
10. What variables could I use to make the best prediction?

  To classify the missile tests as success or failure, I can use the following predictive models:
  
  * **Prediction Model One**:  Missile Types and Apogee 
  * **Prediction Model Two**:  Missile Types, Facility Name, and Apogee
  * **Prediction Model Three**: Missile Type, Facility Name, Facility Location, Apogee
  * **Prediction Model Four**:  Missile Type, Facility Name, Facility Location, Distance Travelled, Apogee 
  * **Prediction Model Five**: Missile Type, Facility Name, Facility Location, Distance Travelled, Apogee, Confirmation Status
  * **Prediction Model Six**:  Missile Types
  * **The results of each Logistic Regression models** are shown in **Table 4.2** and **Figure 4.1.1, 4.1.2, 4.1.3**
  
## Summary of problems approach solution

  **Handle missing  values**
  - In this dataset a failed missile test does not have distance travelled and apogee attributes, therefore I used the median of missile types to impute missing values.  
  
  **Missile Trends**
  - In order to look at the Apogee trends for each missile types, I used the column date and converted it into a POSIX date time object and plot the missile apogee based on its type. 
  
  **Improving North Korea's Missile Test outcome classification**:
  
  - **Training and Testing**: Split the data into **80%** of training dataset and **20%** of testing dataset, train the predictive model on the training set, and test the model on the testing set in order to see how well a given algorithm performs. The purpose of splitting the dataset into training and testing is that, I can treat the testing data like out-of-sample data. Also, the testing accuracy is a better estimate of out-of-sample performance than the training accuracy.
  
  - **Standardizing the feature matrix** (Missile.Type, Facility.Name,Facility.Location, Distance Travelled, Apogee, Confirmation.Status) actually decreases the accuracy from **82.11%** to **74.59%** and increase the error rate from 0.1789 to 0.2541. Also, the AUC of the standardized feature matrix is 0.5, which indicates that the prediction model is simply peforms random guessing.
  
  - **Classifying Missile Test Outcome with KNN Alogrithm, using K-observations ranges from 5 to 25.**: As I mentioned above, KNN performs better, when the K observation is equal to 8 or 9 (As you can see in **Figure 5.3**). Also, the KNN algorithm has the highest accuracy and the lowest error rates (As you can see in **Figure 5.1 and 5.2** ), when K-observation equals to 5 but I would still choose K-observation equals to 8 or 9 because the AUC scores evaluates the Algorithm performance. An AUC score close to 1, indicates a perfect model. On the other hand, an AUC score close to 0.5 or within this range indicates that the model simply peforms random guessing
  
  **Improving regression model in predicting missile apogee**
  * To improve the regression model prediction, I used mining technique to search for the best regression models with the lowest RMSE and the highest ${{R}^2}$. The results are shown in **Figure 6.1.1 and 6.1.2** and **Table 4.4.3**
  
## Summary of Interesting Insights 

  * **Figure 1.4.3** shows all the missiles that are successfully develop by the North Korea from 1984 to 2019. the newest crop of North Korean weapons - including Hwasong 12, 14, and 15, KN 23 and 25, Musudan, Scud-C MarV, Pukguksong 2 and 3, ER Scud. Demonstrates mobility, potency, precision, and has characteristics that make the missiles hard to defat in flight **[5]**. These traits show that the North Korean test program is trying to achieve more than a simple political statement. It may be intended to increase the reliability, effectiveness, and survivability of their ballistic missile force. Moreover, the North Korean missile tests have demonstrated growing success especially in the year of 2019 (As illustrated in **Figure 1.5 and 1.8** and **Table 2.3 and 3.1**). Which suggested a pattern designed to strengthen the credibility of North Korea's regional nuclear deterrent strategy. 
  
## Summary of the implications to the consumer
  
  * Looking at the numbers of missiles tested by the North Korea from April 09,1984 to March 03,2020. I can see that North Korea had **79.19%** success rate, **18.79%** failure rate, and **2.01%** unknown test results. Under Kim Jong-Un, North Korea has conducted a total 118 missile tests with the success rate of **82.20%** and failure rate of **16.95%**. During Kim Jong-Un presidency, he has conducted 73 SRBM, 17 MRBM, 14 IRBM, 7 SLBM, 3 ICBM, 3 SLV, and 1 Unknown tests. The majority of **IRBM** tests were conducted at **Wonsan Kalma International Airport** located in **Kangwon Province, (North Korea)** and the majority of **MRBM** tests were conducted at **Cholsan County, North Pyongan Province** located in **Sohae Satellite Launching Station**. Looking at the missile types, landing locations, apogee and distance travelled trends, as well as the test outcome. It appears that Kim Jung-Un is very ambitious to build ballistic missiles that are capable of defeating the effectiveness of missile defenses deployed in the region such as Patriot, Aegis Ballistic Missile Defense (**BMD**), and Terminal High Altitude Area Defense (**THAAD**). Also, the advancement in SLBM (Submarine Launched Ballistic Missile) indicates North Korea efforts to defeat or counter land-based **THAAD**, by firing missile from positions at sea outside the THAAD's radar field. 
  
## Limitations 

  * The RMSE for predicting North Korea's Missile Apogee still significantly bigger (390 to 500) and the ${{R}^2}$ still very small (11% to 25%). The ${{R}^2}$ is useful to tell us about the proportion of variance explained by the predictive models. To overcome this problems, I need to write a function with random permutations to select the predictive models with the lowest RMSE and ${{R}^2}$. 
  
  * The accuracy from knn still bellow 90% and the AUC scores are between (0.6 to 0.7). To overcome this problems, I need to write a function with random permutations to select the predictive models with the highest accuracy and auc scores, and the lowest error rates. 
  
## References

1. Musudan (BM-25). (n.d.). Retrieved July 31, 2020, from https://missilethreat.csis.org/missile/musudan/
2. The CNS North Korea Missile Test Database. (2020, March 31). Retrieved July 31, 2020, from https://www.nti.org/analysis/articles/cns-north-korea-missile-test-database/
3. Shahab-2. (n.d.). Retrieved July 31, 2020, from https://missilethreat.csis.org/missile/shahab-2/
4. North Koreas Nuclear Weapons and Missile Programs. (n.d.). Retrieved August 3, 2020, from https://crsreports.congress.gov/product/pdf/IF/IF10472
5. Hwasong-6 ('Scud C' Variant). (n.d.). Retrieved August 04, 2020, from https://missilethreat.csis.org/missile/hwasong-6/
6. North Koreas Nuclear Weapons and Missile Programs. (2020, July 14). Retrieved August 04, 2020, from https://fas.org/sgp/crs/nuke/IF10472.pdf 

